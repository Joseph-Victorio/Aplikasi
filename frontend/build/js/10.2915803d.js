(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"48e4":function(t,e,s){},"841d":function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t._self._c;return e("q-page",{attrs:{padding:""}},[e("q-header",{staticClass:"text-primary bg-white box-shadow"},[e("q-toolbar",[e("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"eva-arrow-back"},on:{click:function(e){return t.$router.back()}}}),e("q-toolbar-title",{staticClass:"text-weight-bold brand"},[t._v("Form Pemesanan")])],1)],1),t.can_ship?e("div",[e("WithShipping")],1):e("div",[e("WithoutShipping")],1)],1)},i=[],a=(s("b0c0"),function(){var t=this,e=t._self._c;return e("div",[t.carts&&t.carts.items.length?e("div",{ref:"top",staticClass:"q-pb-xl",attrs:{id:"checkout"}},[e("shipping-address",{attrs:{isModalAddress:t.isAvailableOldAddress},on:{closeModal:function(e){t.isAvailableOldAddress=!1}}}),e("div",{},[e("fieldset",{staticClass:"q-mt-lg"},[e("legend",{staticClass:"q-pa-sm"},[t._v("Ringkasan Order")]),t.formOrder.items.length?e("div",{staticClass:"q-mb-md"},[e("q-separator"),e("q-list",{attrs:{separator:""}},[e("q-item",{staticClass:"bg-grey-1",attrs:{dense:""}},[e("q-item-section",[e("q-item-label",[t._v("Produk")])],1),e("q-item-section",{attrs:{side:""}},[e("q-item-label",[t._v("Subtotal")])],1)],1),t._l(t.formOrder.items,(function(s){return e("q-item",{key:s.id},[e("q-item-section",{attrs:{avatar:"",top:""}},[e("q-img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:s.image_url}})],1),e("q-item-section",[e("div",{staticClass:"col"},[e("div",{staticClass:"text-weight-medium"},[t._v(t._s(s.name))]),e("div",{staticClass:"text-caption text-grey-7"},[t._v(t._s(s.note))]),e("div",{staticClass:"text-grey-7"},[t._v(t._s(s.quantity+"X "+t.moneyIDR(s.price)))])])]),e("q-item-section",{attrs:{side:""}},[e("q-item-label",[t._v(t._s(t.moneyIDR(s.price*s.quantity)))])],1)],1)}))],2)],1):t._e(),e("q-separator"),e("div",{staticClass:"flex justify-end q-py-sm"},[e("table",{staticClass:"table dense"},[e("tr",[e("td",{attrs:{align:"right"}},[t._v("Jumlah")]),e("td",{attrs:{align:"right"}},[t._v(":")]),e("td",{attrs:{align:"right"}},[t._v(t._s(t.moneyIDR(t.formOrder.subtotal)))])]),e("tr",[e("td",{attrs:{align:"right"}},[t._v("Ongkos Kirim")]),e("td",{attrs:{align:"right"}},[t._v(":")]),e("td",{attrs:{align:"right"}},[t._v(t._s(t.formOrder.shipping_cost?t.moneyIDR(t.formOrder.shipping_cost):0))])]),e("tr",{staticStyle:{"border-bottom":"1px solid"}},[e("td",{attrs:{align:"right"}},[t._v("Total")]),e("td",{attrs:{align:"right"}},[t._v(":")]),e("td",{attrs:{align:"right"}},[t._v(t._s(t.moneyIDR(t.formOrder.total)))])])])]),t.formOrder.payment_fee?e("div",{staticClass:"flex justify-end q-mt-sm bg-grey-1 q-py-sm"},[e("table",{staticClass:"table dense"},[t.formOrder.payment_fee?e("tr",[e("td",{staticClass:"text-xs",attrs:{align:"right"}},[t._v("Payment Fee [ "+t._s(t.formOrder.payment_name)+" ]")]),e("td",{attrs:{align:"right"}},[t._v(":")]),e("td",{attrs:{align:"right"}},[t._v(t._s(t.moneyIDR(t.formOrder.payment_fee)))])]):t._e(),e("tr",[e("th",{attrs:{align:"right"}},[t._v("Total Tagihan")]),e("td",{attrs:{align:"right"}},[t._v(":")]),e("th",{attrs:{align:"right"}},[t._v(t._s(t.moneyIDR(t.formOrder.total+t.formOrder.payment_fee)))])])])]):t._e()],1)])],1):t._e(),e("q-footer",{staticClass:"bg-white q-pa-md"},[e("q-btn",{staticClass:"full-width q-mt-sm",attrs:{color:"green-6","no-caps":"",disable:t.stateLoading},on:{click:t.checkout}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 50 50",width:"20px",height:"20px"}},[e("g",{attrs:{id:"surface1441897"}},[e("path",{staticStyle:{stroke:"none","fill-rule":"nonzero",fill:"currentColor","fill-opacity":"1"},attrs:{d:"M 25 2 C 12.316406 2 2 12.316406 2 25 C 2 28.960938 3.023438 32.855469 4.964844 36.289062 L 2.035156 46.730469 C 1.941406 47.074219 2.035156 47.441406 2.28125 47.695312 C 2.472656 47.894531 2.734375 48 3 48 C 3.078125 48 3.160156 47.988281 3.238281 47.972656 L 14.136719 45.273438 C 17.464844 47.058594 21.210938 48 25 48 C 37.683594 48 48 37.683594 48 25 C 48 12.316406 37.683594 2 25 2 Z M 36.570312 33.117188 C 36.078125 34.476562 33.71875 35.722656 32.585938 35.886719 C 31.566406 36.035156 30.277344 36.101562 28.863281 35.65625 C 28.007812 35.386719 26.90625 35.027344 25.496094 34.429688 C 19.574219 31.902344 15.707031 26.011719 15.410156 25.625 C 15.117188 25.234375 13 22.464844 13 19.59375 C 13 16.726562 14.523438 15.3125 15.066406 14.730469 C 15.609375 14.144531 16.246094 14 16.640625 14 C 17.035156 14 17.429688 14.003906 17.773438 14.019531 C 18.136719 14.039062 18.625 13.882812 19.101562 15.023438 C 19.59375 16.191406 20.777344 19.058594 20.921875 19.351562 C 21.070312 19.644531 21.167969 19.984375 20.972656 20.375 C 20.777344 20.761719 20.679688 21.007812 20.382812 21.347656 C 20.085938 21.6875 19.761719 22.105469 19.496094 22.367188 C 19.199219 22.660156 18.894531 22.976562 19.238281 23.558594 C 19.582031 24.144531 20.765625 26.050781 22.523438 27.597656 C 24.777344 29.585938 26.679688 30.199219 27.269531 30.492188 C 27.859375 30.785156 28.203125 30.734375 28.550781 30.347656 C 28.894531 29.957031 30.023438 28.644531 30.417969 28.058594 C 30.8125 27.476562 31.203125 27.574219 31.746094 27.769531 C 32.289062 27.960938 35.191406 29.371094 35.78125 29.664062 C 36.371094 29.957031 36.765625 30.101562 36.914062 30.34375 C 37.0625 30.585938 37.0625 31.753906 36.570312 33.117188 Z M 36.570312 33.117188 "}})])]),e("span",{staticClass:"q-ml-sm"},[t._v("\n            "+t._s(t.isOk?"Proses Order":"Lengkapi data untuk Order")+"\n         ")])])],1)],1)}),o=[],n=(s("ac1f"),s("5319"),s("2ca0"),s("1276"),s("a15b"),s("caad"),s("b64b"),s("d3b7"),s("e6cf"),s("a79d"),s("159b"),s("99af"),function(){var t=this,e=t._self._c;return e("div",{},[e("div",{ref:"courier",staticClass:"q-mb-lg",attrs:{id:"courier"}},[e("div",{attrs:{id:"shipping_destination"}},[e("div",{attrs:{flat:"",bordered:"",id:"customer"}},[e("fieldset",[e("legend",{staticClass:"q-mb-sm"},[t._v("Detail Penerima")]),e("div",{staticClass:"q-gutter-y-md"},[e("q-input",{attrs:{filled:"",square:"","stack-label":"",label:"Nama Penerima",error:t.errors.customer_name,debounce:"1000"},model:{value:t.customer_name,callback:function(e){t.customer_name=e},expression:"customer_name"}}),t.canEmail?e("q-input",{attrs:{filled:"",square:"","stack-label":"",type:"email",required:"",label:"Alamat Email",error:t.errors.customer_email,debounce:"1000"},model:{value:t.customer_email,callback:function(e){t.customer_email=e},expression:"customer_email"}}):t._e(),e("q-input",{attrs:{label:"No ponsel / Whatsapp",filled:"",square:"","stack-label":"",type:"number",error:t.errors.customer_phone,debounce:"1000"},model:{value:t.customer_phone,callback:function(e){t.customer_phone=e},expression:"customer_phone"}})],1)])]),e("div",{staticClass:"q-mt-md",attrs:{flat:"",bordered:"",id:"shipping"}},[e("fieldset",[t._m(0),e("div",{staticClass:"q-pa-md bg-grey-2"},[t.formOrder.shipping_destination?e("div",[e("q-badge",{staticClass:"q-mb-sm",attrs:{color:"green"}},[t._v(t._s(t.formOrder.shipping_destination.label))]),e("div",[t._v(t._s(t.formOrder.shipping_destination.address_street))]),e("div",[t._v(t._s(t.formOrder.shipping_destination.address.label))]),e("q-btn",{staticClass:"q-mt-sm",attrs:{"no-caps":"",label:"Ganti Alamat",color:"amber-10",unelevated:"",size:"sm"},on:{click:t.handleOpenAddressModal}})],1):e("div",{staticClass:"justify-center"},[t.user_address.length?e("q-btn",{staticClass:"full-width",attrs:{"no-caps":"",label:"Pilih Alamat",color:"teal",unelevated:""},on:{click:t.handleOpenAddressModal}}):e("div",{staticClass:"text-center"},[e("div",{staticClass:"text-md q-mb-md"},[t._v("Belum ada alamat tersimpan")]),e("q-btn",{attrs:{"no-caps":"",label:"Tambah Alamat",color:"primary",unelevated:""},on:{click:t.handleAddAddress}})],1)],1)])]),t.errors.shipping_destination?e("div",{staticClass:"text-red q-pa-xs text-xs"},[t._v("Pengiriman belum dipilih")]):t._e()]),e("div",{staticClass:"q-mt-md",attrs:{flat:"",bordered:""}},[e("fieldset",[e("legend",{staticClass:"q-mb-sm"},[t._v("Kurir & Ongkos Kirim")]),e("div",{staticClass:"relative q-py-sm",staticStyle:{"max-height":"300px","overflow-y":"auto"}},[t.shippingCostReady?e("q-list",{attrs:{separator:""}},[t.render_shipping_costs.length?t._l(t.render_shipping_costs,(function(s,r){return e("q-item",{key:r,staticClass:"q-px-xs",class:{"bg-green-1":t.selected_cost&&t.selected_cost.id==s.id},attrs:{clickable:""},on:{click:function(e){return t.selectCost(s)}}},[e("q-item-section",{attrs:{side:""}},[e("q-icon",{attrs:{name:t.selected_cost&&t.selected_cost.id==s.id?"radio_button_checked":"radio_button_unchecked",color:t.selected_cost&&t.selected_cost.id==s.id?"primary":"grey-6"}})],1),e("q-item-section",[e("q-item-label",{staticClass:"text-weight-medium text-grey-9"},[t._v("\n                                 "+t._s(s.courier_name)+"\n                              ")]),e("q-item-label",{staticClass:"text-weight-bold text-grey-9"},[t._v("Ongkos Kirim "+t._s(t.moneyIDR(s.price)))]),e("q-item-label",{staticClass:"text-grey-8"},[t._v("\n                               "+t._s(s.courier_service_name)+" ("+t._s(s.courier_service_code)+")\n                              ")]),e("q-item-label",{staticClass:"text-grey-8"},[t._v("\n                                 Etd "+t._s(s.duration?s.duration:"-")+"\n                              ")])],1)],1)})):t._e(),t.costNotFound?e("q-item",[e("q-item-section",[e("q-item-label",{staticClass:"text-red-5 q-pa-lg"},[t._v("Ongkos kirim tidak ditemukan, silahkan hubungi\n                              admin")])],1)],1):t._e()],2):t._e()],1),e("div",{ref:"courier_skeleton"},[t.loading?e("q-list",t._l(3,(function(t){return e("q-item",{key:t},[e("q-item-section",{attrs:{avatar:"",top:""}},[e("div",{staticClass:"q-pa-sm"},[e("q-skeleton",{staticClass:"round",attrs:{width:"20px",height:"20px"}})],1)]),e("q-item-section",[e("q-skeleton",{attrs:{type:"text",width:"80px"}}),e("q-skeleton",{attrs:{type:"text",width:"180px"}}),e("q-skeleton",{attrs:{type:"text",width:"110px"}}),e("q-skeleton",{attrs:{type:"text",width:"90px"}})],1)],1)})),1):t._e()],1)])])])]),e("q-dialog",{model:{value:t.useDataUserPrompt,callback:function(e){t.useDataUserPrompt=e},expression:"useDataUserPrompt"}},[e("q-card",{staticStyle:{"max-width":"400px"}},[e("q-card-section",[e("div",{staticStyle:{"font-size":"17px","font-weight":"500","margin-bottom":"6px"}},[t._v("Halo kak,")]),e("div",[t._v("Kami menemukan data alamat tersimpan dari order sebelumnya. Apakah akan menggunakan data tersebut?\n            ")])]),e("q-card-actions",{staticClass:"justify-end"},[e("q-btn",{attrs:{size:"12px",outline:"",color:"primary",label:"Tidak"},on:{click:t.closeModalAddress}}),e("q-btn",{attrs:{size:"12px",unelevated:"",color:"primary",label:"Ya Gunakan"},on:{click:t.setDataUser}})],1)],1)],1),e("UserAddressForm",{ref:"userAddressForm",attrs:{autoSelectModal:""},on:{onSelectAddress:t.handleSelectAddress}}),e("div",{attrs:{id:"mapView"}})],1)}),c=[function(){var t=this,e=t._self._c;return e("legend",{staticClass:"q-mb-sm"},[e("div",[t._v("Tujuan Pengiriman")])])}],d=s("448a"),l=s.n(d),m=(s("d81d"),s("b680"),s("0481"),s("758b")),u=function(){var t=this,e=t._self._c;return e("div",[e("q-dialog",{model:{value:t.addressModal,callback:function(e){t.addressModal=e},expression:"addressModal"}},[e("q-card",{staticClass:"card-lg"},[t.user_address.length?e("q-card-section",[e("div",{staticClass:"card-title flex justify-between q-mb-md items-center"},[e("div",[t._v("Pilih Alamat")]),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",icon:"close",round:"",dense:""}})],1),e("div",{staticClass:"scroll q-pa-sm bg-grey-2",staticStyle:{height:"50vh"}},[e("q-list",{attrs:{separator:""}},t._l(t.user_address,(function(s,r){return e("q-item",{key:r,staticClass:"bg-white"},[e("q-item-section",[e("q-item-label",{staticClass:"row items-center q-gutter-x-sm"},[e("div",{staticClass:"text-md"},[t._v(t._s(s.label)+" ")]),s.is_primary?e("q-badge",{attrs:{color:"green",label:"Utama"}}):t._e()],1),e("q-item-label",{staticClass:"q-pt-xs text-grey-7"},[t._v(t._s(s.address_street))]),e("q-item-label",{staticClass:"text-grey-7"},[t._v(t._s(s.address.name))]),s.is_complete?t._e():e("q-item-label",[e("q-badge",{attrs:{color:"red-4",outline:""}},[t._v("incomplete")])],1)],1),e("q-item-section",{staticClass:"q-gutter-xs",attrs:{side:""}},[s.is_complete?e("q-btn",{staticStyle:{width:"70px"},attrs:{unelevated:"",label:"Pilih",color:"teal",size:"sm"},on:{click:function(e){return t.selectAddress(s)}}}):t._e(),e("q-btn",{staticStyle:{width:"70px"},attrs:{unelevated:"",label:"Edit",color:"blue",size:"sm"},on:{click:function(e){return t.handleEditAddress(s)}}}),e("q-btn",{staticStyle:{width:"70px"},attrs:{unelevated:"",label:"Delete",color:"red",size:"sm"},on:{click:function(e){return t.handleDeleteAddress(s.id)}}})],1)],1)})),1)],1),e("div",{staticClass:"q-pa-sm"},[e("q-btn",{staticClass:"full-width",attrs:{label:"Tambah Alamat",color:"primary"},on:{click:t.handleAddAddress}})],1)]):t._e()],1)],1),e("q-dialog",{attrs:{persistent:"","no-shake":"",position:"bottom"},model:{value:t.formAddressModal,callback:function(e){t.formAddressModal=e},expression:"formAddressModal"}},[e("q-card",{staticClass:"max-width"},[e("q-card-section",{staticClass:"q-pa-none",staticStyle:{"min-height":"320px"}},[e("div",{staticClass:"card-title flex justify-between q-py-sm q-px-md sticky-top bg-white"},[e("div",[t._v(t._s("PUT"==t.formAddress._method?"Edit":"Tambah")+" Alamat")]),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",dense:""}})],1),e("div",{staticClass:"q-pa-md"},[e("form",{staticClass:"q-gutter-y-md",on:{submit:function(e){return e.preventDefault(),t.submitAddress.apply(null,arguments)}}},[e("q-input",{attrs:{filled:"",required:"",label:"Label",placeholder:"eg: Kantor"},model:{value:t.formAddress.label,callback:function(e){t.$set(t.formAddress,"label",e)},expression:"formAddress.label"}}),e("div",{staticClass:"q-mt-sm"},[e("q-select",{attrs:{required:"",filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":1e3,label:"Ketik Kecamatan",options:t.subdistrict_options},on:{input:t.selectCurrentAddress,filter:t.filterFn},scopedSlots:t._u([{key:"no-option",fn:function(){return[e("q-item",[e("q-item-section",{staticClass:"text-grey"},[t._v("\n                                 No results\n                              ")])],1)]},proxy:!0}]),model:{value:t.formAddress.address,callback:function(e){t.$set(t.formAddress,"address",e)},expression:"formAddress.address"}})],1),e("q-input",{attrs:{filled:"",required:"",type:"textarea",label:"Alamat Lengkap"},model:{value:t.formAddress.address_street,callback:function(e){t.$set(t.formAddress,"address_street",e)},expression:"formAddress.address_street"}}),t.config?e("div",{staticClass:"q-mt-md q-pa-sm"},[e("div",{staticClass:"card-subtitle"},[e("div",[t._v("Pilih Koordinat")]),e("q-item-label",{attrs:{caption:""}},[t._v("\n                           Klik pada map atau geser posisi ikon kurir untuk mendapatkan koordinat yang tepat\n                        ")])],1),e("div",[e("ClientMap",{ref:"clientMap",attrs:{config:t.config,coordinate:t.formAddress.coordinate,is_client:!0},on:{onEmitMap:t.onEmitMap,onSelectAddress:t.selectMapAddress,onError:function(e){return t.error_map=e}}}),t.error_map?e("div",{staticClass:"text-amber-10 q-pa-xs text-sm"},[t._v(t._s(t.error_map))]):t._e()],1)]):t._e(),t.user_address.length?e("q-checkbox",{attrs:{label:"Gunakan sebagai alamat utama"},model:{value:t.formAddress.is_primary,callback:function(e){t.$set(t.formAddress,"is_primary",e)},expression:"formAddress.is_primary"}}):t._e(),e("div",{staticClass:"card-action q-py-md sticky-bottom bg-white",staticStyle:{"z-index":"1000"}},[e("q-btn",{staticClass:"full-width",attrs:{label:"Simpan Alamat",color:"primary",type:"submit"}})],1)],1)])])],1)],1)],1)},h=[],p=s("c973"),f=s.n(p),_=s("ded3"),g=s.n(_),v=(s("96cf"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"relative"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.showList,expression:"showList"}],staticClass:"list-box-content"},[e("q-list",{attrs:{separator:""}},[t._l(t.lists,(function(s,r){return e("q-item",{key:r,attrs:{clickable:""},on:{click:function(e){return t.selectItemList(s)}}},[e("q-item-section",[t._v(t._s(s.label))])],1)})),t.notFound?e("q-item",[e("q-item-section",{staticClass:"text-center"},[t._v("Data tidak ditemukan")])],1):t._e()],2)],1),t._m(0)])}),b=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"relative"},[e("div",{attrs:{id:"clientMapContiner"}})])}],C=(s("841c"),s("6cc5"),s("e11e")),q=s.n(C),y=s("ac00"),k=(s("1615"),{props:["coordinate","config"],data:function(){return{map:null,zoom:11,searchControl:null,originMarker:null,destinationMarker:null,originMarkerOption:{clickable:!1,draggable:!1,icon:null},destinationMarkerOption:{clickable:!0,draggable:!0,autoPan:!0,icon:null},query:"",provider:null,lists:[],listSelected:null,searchLoading:!1,notFound:!1,totalDistanceKm:0,totaldistanceMinutes:0,freeOngkirUnder:2,hargaJarakPerKm:500,loading:!1,lastLocalCost:0,maxDistance:0,user_coordinate:[],warehouse_coordinate:[],polyline:null,default_center:[-7.969945177009877,110.6048905849457]}},mounted:function(){var t=this;this.$nextTick((function(){setTimeout((function(){t.initialMap()}),700)}))},beforeUnmount:function(){this.map.remove()},watch:{totalDistanceKm:function(){this.getLocalCost()}},computed:{showList:function(){return this.lists.length||this.notFound},shop:function(){return this.$store.state.shop}},methods:{autoSearch:function(t){var e=this;this.provider.search({query:t}).then((function(t){t&&t.length&&e.selectItemList(t[0])}))},searchQuery:function(){var t=this;this.query.length<4||(this.notFound=!1,this.searchLoading=!0,this.provider.search({query:this.query}).then((function(e){t.lists=e})).finally((function(){t.searchLoading=!1,t.lists.length||(t.notFound=!0,setTimeout((function(){t.notFound=!1}),5e3))})))},inputQuery:function(){this.notFound=!1},selectItemList:function(t){this.listSelected=t;var e=[t.y,t.x];this.lists=[],this.setMapView(e),this.setDestinationMarker(e),this.$emit("onSelectAddress",t)},initialMap:function(){this.provider=new y["a"]({params:{countrycodes:"id"}}),this.destinationMarkerOption.icon=q.a.icon({iconUrl:"/static/location.png",iconSize:[60,60],iconAnchor:[30,60]}),this.config.warehouse_coordinate&&this.config.warehouse_coordinate.length&&(this.center=this.config.warehouse_coordinate),this.map=q.a.map("clientMapContiner",{center:this.coordinate.length?this.coordinate:this.center,zoom:this.zoom}),this.config&&this.config.mapbox_access_token?q.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=".concat(this.config.mapbox_access_token),{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:20,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1}).addTo(this.map):q.a.tileLayer("https://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(this.map),this.coordinate&&this.coordinate.length&&this.setDestinationMarker(this.coordinate),this.map.on("click",this.handleMapClicked)},handleMapClicked:function(t){var e=this,s=q.a.DomUtil.create("div"),r=q.a.DomUtil.create("button","",s);r.setAttribute("type","button"),r.innerHTML="Pilih lokasi disini",q.a.popup().setContent(s).setLatLng(t.latlng).openOn(this.map),q.a.DomEvent.on(r,"click",(function(){e.setDestinationMarker([t.latlng.lat,t.latlng.lng])}))},setDestinationMarker:function(t){this.polyline&&(this.map.removeLayer(this.polyline),this.polyline=null),this.user_coordinate=t,void 0!=this.destinationMarker&&(this.destinationMarker=null,this.map.removeLayer(this.destinationMarker)),this.destinationMarker=q.a.marker(t,this.destinationMarkerOption),this.destinationMarker.addTo(this.map),this.destinationMarker.on("dragend",this.handleMArkerDragend),this.setMapView(t),this.loading=!1},handleMArkerDragend:function(t){var e=t.target._latlng;this.setMapView([e.lat,e.lng])},setMapView:function(t){var e=this;this.$emit("onEmitMap",t),setTimeout((function(){e.map.setView(t),e.map.closePopup()}),300)},getCurrentPosition:function(){this.loading=!0;var t={enableHighAccuracy:!0,timeout:8e3,maximumAge:0};navigator.geolocation?navigator.geolocation.getCurrentPosition(this.geoLocationSuccess,this.geoLocationError,t):(this.loding=!1,this.$q.notify({type:"warning",message:"Geolocation is not supported by this browser."}))},geoLocationError:function(){this.loading=!1,this.$q.notify({type:"warning",message:"Lokasi tidak ditemukan, coba ulangi sekali lagi."})},geoLocationSuccess:function(t){var e=this;setTimeout((function(){e.setDestinationMarker([t.coords.latitude,t.coords.longitude]),e.loding=!1}),500)}}}),O=k,x=(s("f590"),s("2877")),A=s("1c1c"),w=s("66e5"),S=s("4074"),D=s("9c40"),$=s("eebe"),M=s.n($),I=Object(x["a"])(O,v,b,!1,null,"cf07b43a",null),R=I.exports;M()(I,"components",{QList:A["a"],QItem:w["a"],QItemSection:S["a"],QBtn:D["a"]});var T={components:{ClientMap:R},props:{autoSelectModal:{type:Boolean,default:!1}},data:function(){return{error_map:"",addressModal:!1,formAddressModal:!1,formAddress:{_method:"",id:"",label:"",is_primary:!1,address_street:"",coordinate:[],address:""},subdistrict_options:[]}},mounted:function(){var t=this;setTimeout((function(){t.user_address.length&&t.selectAddress(t.user_address[0])}),400)},computed:{user_address:function(){return this.$store.state.user.address},config:function(){return this.$store.state.config}},methods:{selectAddress:function(t){this.$store.commit("CLEAR_ERRORS"),this.$emit("onSelectAddress",t),this.addressModal=!1},selectCurrentAddress:function(t){this.error_map="";var e="".concat(t.subdistrict," ").concat(t.city.replace("Kabupaten ",""));this.$refs.clientMap.autoSearch(e)},selectMapAddress:function(t){var e=[t.y,t.x];this.formAddress.coordinate=e},onEmitMap:function(t){this.formAddress.coordinate=t},submitAddress:function(){var t=this;this.handleSavelocalAddress(),setTimeout((function(){1==t.user_address.length&&t.selectAddress(t.user_address[0])}),500)},handleSavelocalAddress:function(){this.formAddress.id||(this.formAddress.id=this.getRandomString(16)),this.formAddress.is_complete=!0,this.$store.commit("user/PUSH_ADDRESS",this.formAddress),this.formAddressModal=!1},handleOpenAddressModal:function(){this.addressModal=!0},handleAddAddress:function(){this.formAddress._method="POST",this.formAddress.id="",this.formAddress.label="",this.formAddress.is_primary=!1,this.formAddress.address_street="",this.formAddress.address="",this.user_address.length||(this.formAddress.label="Rumah"),this.addressModal=!1,this.formAddressModal=!0},handleEditAddress:function(t){var e=g()({},t);this.formAddress=g()(g()({},this.formAddress),e),e.address&&(this.subdistrict_options=[e.address]),this.formAddressModal=!0},filterFn:function(t,e,s){var r=this;return f()(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(!(""==t||t.length<=3)){s.next=3;break}return e(),s.abrupt("return");case 3:Object(m["a"])().get("searchAddress/"+t).then((function(t){t.data.success?e((function(){r.subdistrict_options=t.data.results})):r.$q.notify({type:"negative",message:t.data.message})})).catch((function(t){r.$q.notify({type:"negative",message:t.response.data.message}),e()}));case 4:case"end":return s.stop()}}),s)})))()},handleDeleteAddress:function(t){var e=this;this.$q.dialog({title:"Konfirmasi",message:"Yakin Akan menghapus data?",cancel:!0}).onOk((function(){e.$store.commit("user/DELETE_ADDRESS",t),e.$emit("onSelectAddress",null),e.user_address.length||(e.addressModal=!1)}))}}},Q=T,P=s("24e8"),E=s("f09f"),F=s("a370"),U=s("0170"),N=s("58a81"),j=s("27f9"),G=s("ddd8"),K=s("8f8e"),z=s("7f67"),B=Object(x["a"])(Q,u,h,!1,null,null,null),W=B.exports;M()(B,"components",{QDialog:P["a"],QCard:E["a"],QCardSection:F["a"],QBtn:D["a"],QList:A["a"],QItem:w["a"],QItemSection:S["a"],QItemLabel:U["a"],QBadge:N["a"],QInput:j["a"],QSelect:G["a"],QCheckbox:K["a"]}),M()(B,"directives",{ClosePopup:z["a"]});var H={name:"ShippingAddress",components:{UserAddressForm:W},props:{canEmail:{type:Boolean,default:!1}},data:function(){return{shippingCostReady:!1,formAddressModal:!1,addressModal:!1,useDataUserPrompt:!1,selected_cost:null,formGetCost:{origin:"",destination:"",weight:""},shippingCosts:[],local_cost:null}},computed:{user_address:function(){return this.$store.getters["user/getAllAddress"]},costNotFound:function(){return!(!this.shippingCostReady||this.render_shipping_costs.length)},render_shipping_costs:function(){var t=[];return this.formOrder.customer_address&&this.currentConfig.is_pic_order&&t.push({id:"PICKUP",courier_code:"PICKUP",courier_name:"Ambil Di Toko",courier_service_name:"Diambil sendiri oleh pelanggan",courier_service_code:"PICKUP",price:0,type:"other"}),this.local_cost&&(t=[].concat(l()(t),[this.local_cost])),[].concat(l()(t),l()(this.shippingCosts))},customer_address:{set:function(t){this.commitFormOrder("customer_address",t)},get:function(){return this.$store.state.order.formOrder.customer_address}},customer_phone:{set:function(t){this.commitFormOrder("customer_phone",t)},get:function(){return this.$store.state.order.formOrder.customer_phone}},customer_name:{set:function(t){this.commitFormOrder("customer_name",t)},get:function(){return this.$store.state.order.formOrder.customer_name}},customer_email:{set:function(t){this.commitFormOrder("customer_email",t)},get:function(){return this.$store.state.order.formOrder.customer_email}},shipping_destination:{set:function(t){this.commitFormOrder("shipping_destination",t)},get:function(){return this.$store.state.order.formOrder.shipping_destination}},errors:function(){return this.$store.state.errors},formOrder:function(){return this.$store.state.order.formOrder},loading:function(){return this.$store.state.loading},canGetCost:function(){return!!(this.formGetCost.destination&&this.formGetCost.weight&&this.formGetCost.origin)}},mounted:function(){this.setFormGetCost(),localStorage.getItem("_nextwalocaluser")&&(this.customer_name&&this.customer_phone||(this.useDataUserPrompt=!0))},methods:{handleAddAddress:function(){this.$refs.userAddressForm.handleAddAddress()},handleOpenAddressModal:function(){this.$refs.userAddressForm.handleOpenAddressModal()},removeSelectedAddress:function(){this.shipping_destination=null,this.customer_address=""},clearShipping:function(){this.commitFormOrder("shipping_courier_name",""),this.commitFormOrder("shipping_courier_service",""),this.commitFormOrder("shipping_cost",0)},commitFormOrder:function(t,e){this.$store.commit("order/SET_FORM_ORDER",{key:t,value:e}),this.saveDataUser()},selectCost:function(t){this.selected_cost=t,this.commitFormOrder("shipping_courier_name",t.courier_service_name),this.commitFormOrder("shipping_courier_service",t.courier_service_code),this.commitFormOrder("shipping_cost",t.price)},changeNewAddress:function(){this.clearAddress(),this.formGetCost.destination="",this.clearSelectedCost()},closeModalAddress:function(){this.changeNewAddress(),this.useDataUserPrompt=!1,this.$emit("closeModal")},handleSelectAddress:function(t){if(this.clearSelectedCost(),!t)return this.shipping_destination=null,this.customer_address=null,void this.clearAddress();this.shipping_destination=t;var e="".concat(t.address_street.toUpperCase()," \n").concat(t.address.name);this.customer_address=e,this.getCost(),this.currentConfig.can_cod&&t&&t.coordinate&&this.currentConfig.warehouse_coordinate&&this.getLocalCost(t.coordinate)},clearAddress:function(){this.formGetCost.destination="",this.clearSelectedCost(),this.commitFormOrder("shipping_destination","")},setDataUser:function(){var t=JSON.parse(localStorage.getItem("_nextwalocaluser"));this.customer_name=t.customer_name,this.customer_phone=t.customer_phone,this.customer_email=t.customer_email?t.customer_email:"",this.useDataUserPrompt=!1},saveDataUser:function(){if(this.formOrder.customer_name&&this.formOrder.customer_phone){var t={customer_name:this.formOrder.customer_name,customer_phone:this.formOrder.customer_phone,customer_email:this.formOrder.customer_email};localStorage.setItem("_nextwalocaluser",JSON.stringify(t))}},clearSelectedCost:function(){this.local_cost=null,this.shippingCosts=[],this.selected_cost=null,this.clearShipping()},getCost:function(){var t=this;this.setFormGetCost(),this.canGetCost&&(this.jumpTo("shipping"),this.$store.commit("SET_LOADING",!0),Object(m["a"])().post("shipping/costs",this.formGetCost).then((function(e){200==e.status&&(t.shippingCosts=e.data.results,t.$store.commit("SET_LOADING",!1))})).catch((function(){t.$store.commit("SET_LOADING",!1)})).finally((function(){t.shippingCostReady=!0})))},setFormGetCost:function(){this.formGetCost.weight=this.formOrder.weight,this.formOrder.shipping_destination&&(this.formGetCost.destination=this.formOrder.shipping_destination.address.city_id),this.currentConfig&&this.currentConfig.can_shipping&&(this.formGetCost.origin=this.currentConfig.warehouse_address.city_id)},getLocalCost:function(t){this.map||(this.map=L.map("mapView",{center:this.currentConfig.warehouse_coordinate}));var e=this.map.distance(this.currentConfig.warehouse_coordinate,t),s=(e/1e3).toFixed(1);console.log("direct distance: in M",e),console.log("direct distance: in KM",s);var r=this.currentConfig.local_shipping_costs,i=r[r.length-1],a=parseInt(i.end);if(s>a)this.local_cost=null;else{for(var o=null,n=0;n<r.length;n++){var c=r[n],d=parseInt(c.radius);if(!(s>d)){o=c;break}}if(o){var l=0;l=o.flat?parseInt(o.cost):s>0?Math.round(s*parseInt(o.cost)):parseInt(o.cost),this.local_cost={id:"COD",courier_code:"COD",courier_name:"Kurir Toko",courier_service_name:"Diantar oleh kurir toko",courier_service_code:"COD",price:l,type:"other"},this.shippingCostReady=!0}else this.local_cost=null}}}},J=H,V=s("0016"),Z=s("293e"),X=s("4b7e"),Y=Object(x["a"])(J,n,c,!1,null,null,null),tt=Y.exports;M()(Y,"components",{QInput:j["a"],QBadge:N["a"],QBtn:D["a"],QList:A["a"],QItem:w["a"],QItemSection:S["a"],QIcon:V["a"],QItemLabel:U["a"],QSkeleton:Z["a"],QDialog:P["a"],QCard:E["a"],QCardSection:F["a"],QCardActions:X["a"]});var et={components:{ShippingAddress:tt},name:"CheckoutDirectWithShipping",data:function(){return{isAvailableOldAddress:!1}},computed:{carts:function(){return this.$store.getters["cart/getCarts"]},formOrder:function(){return this.$store.getters["order/getFormOrder"]},errors:function(){return this.$store.state.errors},config:function(){return this.$store.state.config},can_pic_order:function(){return!!this.config&&this.config.is_pic_order},isOk:function(){return!!(this.formOrder.customer_name&&this.formOrder.customer_phone&&this.formOrder.shipping_courier_name&&this.formOrder.customer_address)}},mounted:function(){this.carts.items.length||this.$router.back(),this.checkDataUser(),this.collectOrder()},methods:{collectOrder:function(){this.$store.commit("order/COLLECT_ORDER",this.carts)},checkDataUser:function(){localStorage.getItem("user_data")&&(this.isAvailableOldAddress=!0)},handleBackButton:function(){this.$router.push({name:"Cart"})},formatPhoneNumber:function(t){var e=t.replace(/\D/g,"");return e.startsWith("0")&&(e="62"+e.substr(1)),e},getRoutePath:function(t){var e=this.$router.resolve({name:"UserInvoice",params:{order_ref:t}});return location.origin+e.href},formatAddressCod:function(t){var e=t.split("<br>");return e.join("\n")},validateData:function(){this.$store.commit("CLEAR_ERRORS");var t=["customer_name","customer_phone","customer_address"],e=["shipping_destination","shipping_courier_name","shipping_courier_service"];for(var s in this.formOrder)(t.includes(s)||e.includes(s))&&(this.formOrder[s]&&""!=this.formOrder[s]||this.$store.commit("PUSH_ERRORS",{key:s,value:!0}));if(Object.keys(this.errors).length>0){for(var r in this.errors){if("shipping_destination"==r)return this.jumpTo("shipping"),this.$q.notify({type:"negative",message:"Tujuan pengiriman belum diisi"}),!1;if("shipping_courier_service"==r)return this.jumpTo("courier"),this.$q.notify({type:"negative",message:"Kurir belum dipilih"}),!1;if(t.includes(r))return this.jumpTo("customer"),this.$q.notify({type:"negative",message:"Data penerima belum lengkap"}),!1}return!1}return!0},checkout:function(){var t=this;this.validateData()&&this.isOk&&(this.$store.commit("SET_LOADING",!0),this.$q.loading.show({message:"Order sedang diproses. Silahkan tunggu..."}),this.$store.dispatch("order/storeOrder",this.formOrder).then((function(e){if(200==e.status){var s=e.data.results;setTimeout((function(){t.$router.push({name:"UserInvoice",params:{order_ref:s.order_ref}})}),500),t.redirectWhatsapp(s)}})).catch((function(){t.$q.loading.hide()})).finally((function(){setTimeout((function(){t.$store.commit("SET_LOADING",!1)}),3e3)})))},redirectWhatsapp:function(t){var e=this,s=this.getRoutePath(t.order_ref),r="https://api.whatsapp.com";this.$q.platform.is.desktop&&(r="https://web.whatsapp.com");var i=this.formatPhoneNumber(this.currentShop.phone),a="Halo kak, saya mau order:\n\n",o=this.formOrder.items,n=1;o.forEach((function(t){a+="*".concat(n,"). ").concat(t.name,"*\n"),t.note&&(a+="".concat(t.note,"\n")),a+="Qty: ".concat(t.quantity,"\nHarga (@): ").concat(e.moneyIDR(t.price),"\nHarga Total: ").concat(e.moneyIDR(t.quantity*t.price),"\n\n"),n++})),a+="Subtotal: *".concat(this.moneyIDR(this.formOrder.subtotal),"*\n"),a+="Ongkir: *".concat(this.moneyIDR(this.formOrder.shipping_cost),"*\n"),a+="Total: *".concat(this.moneyIDR(this.formOrder.total),"*\n"),a+="-----------------------------------\n\n",a+="*Nama:* ".concat(this.formOrder.customer_name,"\n"),a+="*Ponsel:* ".concat(this.formOrder.customer_phone,"\n\n"),a+="*Alamat:*\n".concat(this.formatAddressCod(this.formOrder.customer_address),"\n\n"),a+="Kurir: ".concat(this.formOrder.shipping_courier_name,"\n"),a+="Servis: ".concat(this.formOrder.shipping_courier_service,"\n\n"),a+="Ref Order: ".concat(s,"\n");var c=r+"/send?phone="+i+"&text="+encodeURI(a);setTimeout((function(){e.$q.loading.hide()}),1e3),setTimeout((function(){e.$store.dispatch("cart/clearCart",e.currentSessionId)}),5e3),window.open(c,"_blank")}}},st=et,rt=s("eb85"),it=s("068f"),at=s("7ff0"),ot=Object(x["a"])(st,a,o,!1,null,null,null),nt=ot.exports;M()(ot,"components",{QSeparator:rt["a"],QList:A["a"],QItem:w["a"],QItemSection:S["a"],QItemLabel:U["a"],QImg:it["a"],QFooter:at["a"],QBtn:D["a"]});var ct=function(){var t=this,e=t._self._c;return e("div",[t.carts&&t.carts.items.length?e("div",{ref:"top",staticClass:"q-pb-xl",attrs:{id:"checkout"}},[e("div",{},[e("div",{attrs:{flat:"",bordered:"",id:"customer"}},[e("fieldset",[e("legend",{staticClass:"q-mb-sm"},[t._v("Detail Pelanggan")]),e("div",{staticClass:"q-gutter-y-sm"},[e("q-input",{attrs:{filled:"",square:"","stack-label":"",label:"Nama",error:t.errors.customer_name,"error-message":"nama belum diisi"},model:{value:t.customer_name,callback:function(e){t.customer_name=e},expression:"customer_name"}}),e("q-input",{attrs:{label:"No ponsel / Whatsapp",filled:"",square:"","stack-label":"",mask:"#### #### #####","unmasked-value":"",error:t.errors.customer_phone,"error-message":"no whatsapp belum diisi"},model:{value:t.customer_phone,callback:function(e){t.customer_phone=e},expression:"customer_phone"}}),e("q-input",{attrs:{label:"Catatan Pesanan",type:"textarea",rows:"3",filled:"",square:"","stack-label":""},model:{value:t.customer_note,callback:function(e){t.customer_note=e},expression:"customer_note"}})],1)])]),e("fieldset",{staticClass:"q-mt-lg"},[e("legend",{staticClass:"q-pa-sm"},[t._v("Ringkasan Order")]),t.formOrder.items.length?e("div",{staticClass:"q-mb-md"},[e("q-separator"),e("q-list",{attrs:{separator:""}},[e("q-item",{staticClass:"bg-grey-1 q-px-xs",attrs:{dense:""}},[e("q-item-section",[e("q-item-label",[t._v("Produk")])],1),e("q-item-section",{attrs:{side:""}},[e("q-item-label",[t._v("Subtotal")])],1)],1),t._l(t.formOrder.items,(function(s){return e("q-item",{key:s.id,staticClass:"q-px-xs"},[e("q-item-section",{attrs:{avatar:"",top:""}},[e("q-img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:s.image_url}})],1),e("q-item-section",[e("div",{staticClass:"col"},[e("div",{staticClass:"text-weight-medium"},[t._v(t._s(s.name))]),e("div",{staticClass:"text-caption text-grey-7"},[t._v(t._s(s.note))]),e("div",{staticClass:"text-grey-7"},[t._v(t._s(s.quantity+"X "+t.moneyIDR(s.price)))])])]),e("q-item-section",{attrs:{side:""}},[e("q-item-label",[t._v(t._s(t.moneyIDR(s.price*s.quantity)))])],1)],1)}))],2)],1):t._e(),e("q-separator"),e("div",{staticClass:"flex justify-end q-py-md"},[e("table",{staticClass:"table dense"},[e("tr",{staticStyle:{"border-bottom":"1px solid"}},[e("td",{attrs:{align:"right"}},[t._v("Total Bayar")]),e("td",{attrs:{align:"right"}},[t._v(":")]),e("td",{attrs:{align:"right"}},[t._v(t._s(t.moneyIDR(t.formOrder.total)))])])])])],1)])]):t._e(),e("q-footer",{staticClass:"bg-white q-pa-md"},[e("q-btn",{staticClass:"full-width q-mt-sm",attrs:{color:"green-6","no-caps":"",disable:t.stateLoading},on:{click:t.checkout}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 50 50",width:"20px",height:"20px"}},[e("g",{attrs:{id:"surface1441897"}},[e("path",{staticStyle:{stroke:"none","fill-rule":"nonzero",fill:"currentColor","fill-opacity":"1"},attrs:{d:"M 25 2 C 12.316406 2 2 12.316406 2 25 C 2 28.960938 3.023438 32.855469 4.964844 36.289062 L 2.035156 46.730469 C 1.941406 47.074219 2.035156 47.441406 2.28125 47.695312 C 2.472656 47.894531 2.734375 48 3 48 C 3.078125 48 3.160156 47.988281 3.238281 47.972656 L 14.136719 45.273438 C 17.464844 47.058594 21.210938 48 25 48 C 37.683594 48 48 37.683594 48 25 C 48 12.316406 37.683594 2 25 2 Z M 36.570312 33.117188 C 36.078125 34.476562 33.71875 35.722656 32.585938 35.886719 C 31.566406 36.035156 30.277344 36.101562 28.863281 35.65625 C 28.007812 35.386719 26.90625 35.027344 25.496094 34.429688 C 19.574219 31.902344 15.707031 26.011719 15.410156 25.625 C 15.117188 25.234375 13 22.464844 13 19.59375 C 13 16.726562 14.523438 15.3125 15.066406 14.730469 C 15.609375 14.144531 16.246094 14 16.640625 14 C 17.035156 14 17.429688 14.003906 17.773438 14.019531 C 18.136719 14.039062 18.625 13.882812 19.101562 15.023438 C 19.59375 16.191406 20.777344 19.058594 20.921875 19.351562 C 21.070312 19.644531 21.167969 19.984375 20.972656 20.375 C 20.777344 20.761719 20.679688 21.007812 20.382812 21.347656 C 20.085938 21.6875 19.761719 22.105469 19.496094 22.367188 C 19.199219 22.660156 18.894531 22.976562 19.238281 23.558594 C 19.582031 24.144531 20.765625 26.050781 22.523438 27.597656 C 24.777344 29.585938 26.679688 30.199219 27.269531 30.492188 C 27.859375 30.785156 28.203125 30.734375 28.550781 30.347656 C 28.894531 29.957031 30.023438 28.644531 30.417969 28.058594 C 30.8125 27.476562 31.203125 27.574219 31.746094 27.769531 C 32.289062 27.960938 35.191406 29.371094 35.78125 29.664062 C 36.371094 29.957031 36.765625 30.101562 36.914062 30.34375 C 37.0625 30.585938 37.0625 31.753906 36.570312 33.117188 Z M 36.570312 33.117188 "}})])]),e("span",{staticClass:"q-ml-sm"},[t._v("\n            "+t._s(t.isOk?"Proses Order":"Lengkapi data untuk Order")+"\n         ")])])],1)],1)},dt=[],lt={computed:{carts:function(){return this.$store.getters["cart/getCarts"]},formOrder:function(){return this.$store.getters["order/getFormOrder"]},errors:function(){return this.$store.state.errors},isOk:function(){return!(!this.formOrder.customer_name||!this.formOrder.customer_phone)},customer_phone:{set:function(t){this.commitFormOrder("customer_phone",t)},get:function(){return this.$store.state.order.formOrder.customer_phone}},customer_name:{set:function(t){this.commitFormOrder("customer_name",t)},get:function(){return this.$store.state.order.formOrder.customer_name}},customer_email:{set:function(t){this.commitFormOrder("customer_email",t)},get:function(){return this.$store.state.order.formOrder.customer_email}},customer_note:{set:function(t){this.commitFormOrder("customer_note",t)},get:function(){return this.$store.state.order.formOrder.customer_note}}},mounted:function(){this.carts.items.length||this.$router.back(),this.collectOrder(),this.setDataUser()},methods:{collectOrder:function(){this.$store.commit("order/COLLECT_ORDER",this.carts)},commitFormOrder:function(t,e){this.$store.commit("order/SET_FORM_ORDER",{key:t,value:e}),this.saveDataUser()},handleBackButton:function(){this.$router.push({name:"Cart"})},formatPhoneNumber:function(t){var e=t.replace(/\D/g,"");return e.startsWith("0")&&(e="62"+e.substr(1)),e},getRoutePath:function(t){var e=this.$router.resolve({name:"UserInvoice",params:{order_ref:t}});return location.origin+e.href},saveDataUser:function(){if(this.formOrder.customer_name&&this.formOrder.customer_phone){var t={customer_name:this.formOrder.customer_name,customer_phone:this.formOrder.customer_phone};localStorage.setItem("_nextshop_wa_current_user",JSON.stringify(t))}},setDataUser:function(){if(localStorage.getItem("_nextshop_wa_current_user")){var t=JSON.parse(localStorage.getItem("_nextshop_wa_current_user"));this.customer_name=t.customer_name,this.customer_phone=t.customer_phone,this.customer_email=t.customer_email?t.customer_email:""}},formatAddressCod:function(t){var e=t.split("<br>");return e.join("\n")},validateData:function(){this.$store.commit("CLEAR_ERRORS");var t=["customer_name","customer_phone"];for(var e in this.formOrder)t.includes(e)&&(this.formOrder[e]&&""!=this.formOrder[e]||this.$store.commit("PUSH_ERRORS",{key:e,value:!0}));if(Object.keys(this.errors).length>0){for(var s in this.errors)if(t.includes(s))return this.jumpTo("customer"),this.$q.notify({type:"negative",message:"Data penerima belum lengkap"}),!1;return!1}return!0},checkout:function(){var t=this;this.validateData()&&this.isOk&&(this.$store.commit("SET_LOADING",!0),this.$q.loading.show({message:"Order sedang diproses. Silahkan tunggu..."}),this.$store.dispatch("order/storeOrder",this.formOrder).then((function(e){if(200==e.status){var s=e.data.results;setTimeout((function(){t.$router.push({name:"UserInvoice",params:{order_ref:s.order_ref}})}),500),t.redirectWhatsapp(s)}})).catch((function(){t.$q.loading.hide()})).finally((function(){setTimeout((function(){t.$store.commit("SET_LOADING",!1)}),3e3)})))},redirectWhatsapp:function(t){var e=this,s=this.getRoutePath(t.order_ref),r="https://api.whatsapp.com";this.$q.platform.is.desktop&&(r="https://web.whatsapp.com");var i=this.formatPhoneNumber(this.currentShop.phone),a="Halo kak, saya mau order:\n\n",o=this.formOrder.items,n=1;o.forEach((function(t){a+="*".concat(n,"). ").concat(t.name,"*\n"),t.note&&(a+="".concat(t.note,"\n")),a+="Qty: ".concat(t.quantity,"\nHarga (@): ").concat(e.moneyIDR(t.price),"\nHarga Total: ").concat(e.moneyIDR(t.quantity*t.price),"\n\n"),n++})),a+="Total: *".concat(this.moneyIDR(this.formOrder.total),"*\n"),a+="-----------------------------------\n\n",a+="*Nama:*\n ".concat(this.formOrder.customer_name,"\n"),a+="*Whatsapp:*\n ".concat(this.formOrder.customer_phone,"\n"),this.formOrder.customer_note&&(a+="Catatan Pembeli:\n".concat(this.formOrder.customer_note,"\n")),a+="\nRef Order: ".concat(s);var c=r+"/send?phone="+i+"&text="+encodeURI(a);setTimeout((function(){e.$q.loading.hide()}),1e3),setTimeout((function(){e.$store.dispatch("cart/clearCart",e.currentSessionId)}),5e3),window.open(c,"_blank")}}},mt=lt,ut=Object(x["a"])(mt,ct,dt,!1,null,null,null),ht=ut.exports;M()(ut,"components",{QInput:j["a"],QSeparator:rt["a"],QList:A["a"],QItem:w["a"],QItemSection:S["a"],QItemLabel:U["a"],QImg:it["a"],QFooter:at["a"],QBtn:D["a"]});var pt={components:{WithShipping:nt,WithoutShipping:ht},computed:{config:function(){return this.$store.state.config},can_ship:function(){return!(!this.config.can_cod&&!this.config.can_shipping)}},created:function(){this.$store.dispatch("getConfig")}},ft=pt,_t=s("9989"),gt=s("e359"),vt=s("65c6"),bt=s("6ac5"),Ct=Object(x["a"])(ft,r,i,!1,null,null,null);e["default"]=Ct.exports;M()(Ct,"components",{QPage:_t["a"],QHeader:gt["a"],QToolbar:vt["a"],QBtn:D["a"],QToolbarTitle:bt["a"]})},f590:function(t,e,s){"use strict";s("48e4")}}]);