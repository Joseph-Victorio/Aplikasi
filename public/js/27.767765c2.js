(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[27],{"8f0d":function(t,i,e){"use strict";e.r(i);e("a4d3"),e("e01a");var o=function(){var t=this,i=t._self._c;return i("q-page",{staticClass:"q-pb-xl",class:{"flex flex-center":!t.blocks.available},attrs:{padding:""}},[i("q-header",[i("q-toolbar",[i("q-btn",{attrs:{to:{name:"Settings"},flat:"",round:"",dense:"",icon:"eva-arrow-back"}}),i("q-toolbar-title",[t._v("\n       List Block\n      ")]),i("q-btn",{staticClass:"gt-xs",attrs:{"no-caps":"",outline:"",icon:"eva-plus-circle",label:"Tambah Block"},on:{click:t.handleAddBlock}})],1)],1),t.blocks.available?[i("q-list",{attrs:{separator:""}},t._l(t.blocks.data,(function(e){return i("q-item",{key:e.id},[i("q-item-section",{staticClass:"q-pr-sm relative",attrs:{side:""}},[e.image?i("img",{staticClass:"rounded-corners",staticStyle:{height:"50px",width:"100px","object-fit":"contain"},attrs:{src:e.image_url}}):t._e()]),i("q-item-section",[i("q-item-label",{staticClass:"text-subtitle2"},[t._v(t._s(e.label))]),e.description?i("q-item-label",{attrs:{caption:""},domProps:{innerHTML:t._s(e.description)}}):t._e(),i("div",{staticClass:"q-mt-xs"},[i("q-chip",{attrs:{size:"sm",outline:"",color:"pink","text-color":"white"}},[t._v("Urutan "+t._s(e.weight))]),i("q-chip",{attrs:{size:"sm",icon:"bookmark",outline:"",color:"blue-7","text-color":"white"}},[t._v(t._s(e.position))]),e.post_id?i("q-chip",{attrs:{size:"sm",icon:"eva-checkmark-circle-2",outline:"",color:"teal","text-color":"white"}},[t._v("Linked")]):t._e()],1)],1),i("q-item-section",{attrs:{side:"",top:""}},[i("div",{staticClass:"text-grey-8 column q-gutter-y-sm"},[i("q-btn",{attrs:{size:"sm",round:"",icon:"eva-trash-2",glossy:"",color:"red"},on:{click:function(i){return t.handleRemoveBlock(e.id)}}}),i("q-btn",{attrs:{size:"sm",round:"",glossy:"",color:"info",icon:"eva-edit-2"},on:{click:function(i){return t.handleEditBlock(e)}}})],1)])],1)})),1)]:[i("div",[t._v("Tidak ada data")])],i("q-inner-loading",{attrs:{showing:!t.blocks.ready}},[i("q-spinner-facebook",{attrs:{size:"50px",color:"primary"}})],1),i("q-page-sticky",{staticClass:"lt-sm",attrs:{position:"bottom-right",offset:[12,12]}},[i("q-btn",{attrs:{fab:"",icon:"add",color:"primary",glossy:""},on:{click:t.handleAddBlock}})],1),i("q-dialog",{model:{value:t.blockModal,callback:function(i){t.blockModal=i},expression:"blockModal"}},[i("q-card",{staticClass:"bg-white",staticStyle:{width:"100%","max-width":"450px"}},[i("div",{staticClass:"card-heading text-md"},[t._v(t._s("add"==t.formType?"Tambah":"Edit")+" Data")]),i("form",{staticClass:"full-width",on:{submit:function(i){return i.preventDefault(),t.submitBlock.apply(null,arguments)}}},[i("q-card-section",{staticClass:"q-gutter-y-md"},[i("q-input",{attrs:{filled:"",required:"",label:"Label"},model:{value:t.form.label,callback:function(i){t.$set(t.form,"label",i)},expression:"form.label"}}),i("q-select",{attrs:{filled:"",options:t.positionOptions,label:"Pilih Tipe"},model:{value:t.form.position,callback:function(i){t.$set(t.form,"position",i)},expression:"form.position"}}),"Featured"==t.form.position?i("q-input",{staticClass:"q-mb-sm",attrs:{filled:"",required:"",label:"Deskripsi",autogrow:""},model:{value:t.form.description,callback:function(i){t.$set(t.form,"description",i)},expression:"form.description"}}):t._e(),i("q-input",{attrs:{filled:"",required:"",label:"Urutan",mask:"####",hint:"Banner"==t.form.position?"Posisi banner: 1 , 2 atau 3":""},model:{value:t.form.weight,callback:function(i){t.$set(t.form,"weight",i)},expression:"form.weight"}}),i("div",{staticClass:"q-mt-md"},[i("q-toggle",{attrs:{label:"Link ke Post"},on:{input:t.handleLinkPost},model:{value:t.linkToPost,callback:function(i){t.linkToPost=i},expression:"linkToPost"}})],1),t.linkToPost?[i("div",{staticClass:"text-grey-7 q-my-sm"},[t._v("Pilih Post")]),i("div",{},[i("q-list",{staticStyle:{"max-height":"150px","overflow-y":"auto"},attrs:{separator:"",bordered:""}},t._l(t.posts.data,(function(e){return i("q-item",{key:e.id,attrs:{clickable:""},on:{click:function(i){return t.selectPostData(e)}}},[i("q-item-section",{attrs:{avatar:""}},[i("q-icon",{attrs:{color:t.form.post_id==e.id?"green-7":"grey-7","text-color":"white",name:t.form.post_id==e.id?"task_alt":"remove_circle_outline"}})],1),i("q-item-section",[t._v(t._s(e.title))])],1)})),1)],1)]:t._e()],2),i("q-card-section",[i("q-btn",{attrs:{color:"primary",size:"sm",label:"Upload Gambar"},on:{click:function(i){return i.preventDefault(),t.handleUploadImage.apply(null,arguments)}}}),i("input",{ref:"image",staticClass:"hidden",attrs:{type:"file"},on:{change:t.handleImagePreview}})],1),t.imagePreview?i("q-card-section",[i("div",{staticClass:"row items-center justify-between q-gutter-x-sm"},[i("img",{staticStyle:{"max-height":"80px",width:"auto","object-fit":"contain"},attrs:{src:t.imagePreview}})])]):t._e(),i("q-card-actions",{staticClass:"justify-end q-pa-md sticky-bottom bg-grey-2"},[i("q-btn",{attrs:{type:"button",color:"primary",outline:"",label:"Batal"},on:{click:function(i){return i.preventDefault(),t.closeModal.apply(null,arguments)}}}),i("q-btn",{attrs:{loading:t.loading,type:"submit",color:"primary",label:"Simpan Data"}})],1)],1)])],1)],2)},a=[],s=e("ded3"),l=e.n(s),n=e("2f62"),r={name:"BlockIndex",data:function(){return{linkToPost:!1,selctedPost:null,loading:!1,formType:"",blockModal:!1,form:{id:"",label:"",description:"",weight:"",position:"",image:"",del_image:!1,post_id:""},imagePreview:"",positionOptions:["Featured","Banner","Partner"]}},computed:l()({},Object(n["e"])({blocks:function(t){return t.block.admin_data},posts:function(t){return t.post.posts}})),mounted:function(){this.blocks.data.length||this.getAdminBlocks(),this.posts.data.length||this.$store.dispatch("post/getAllPost")},methods:l()(l()({},Object(n["b"])("block",["addBlock","updateBlock","getAdminBlocks","getBlockById","deleteBlock"])),{},{selectPostData:function(t){this.form.post_id=t.id},handleLinkPost:function(){this.linkToPost||(this.form.post_id="")},submitBlock:function(){var t=this;"Banner"==this.form.position&&this.form.weight>3?this.$q.dialog({title:"Error",message:"Urutan block tipe banner maksimal adalah 3, Anda bisa pilih no 1, 2 atau 3"}):(this.loading=!0,"add"==this.formType&&this.addBlock(this.form).then((function(i){t.loading=!1,t.closeModal(),t.getAdminBlocks()})).catch((function(){t.loading=!1})),"edit"==this.formType&&this.updateBlock(this.form).then((function(){t.loading=!1,t.closeModal(),t.getAdminBlocks()})).catch((function(){t.loading=!1})))},handleEditBlock:function(t){this.clearForm(),this.formType="edit",this.linkToPost=!!t.post_id,this.form.id=t.id,this.form.post_id=t.post_id,this.form.label=t.label,this.form.description=t.description,this.form.weight=t.weight,this.form.position=t.position,this.imagePreview=t.image_url,this.blockModal=!0},handleRemoveBlock:function(t){var i=this;this.$q.dialog({title:"Konfirmasi Penghapusan Item",message:"Yakin akan menghapus data?",ok:{label:"Hapus",flat:!0,"no-caps":!0},cancel:{label:"Batal",flat:!0,"no-caps":!0}}).onOk((function(){i.deleteBlock(t)})).onCancel((function(){console.log("Cancel")})).onDismiss((function(){}))},handleAddBlock:function(){this.clearForm(),this.blockModal=!0,this.formType="add",this.form.weight=this.blocks.data.length?this.blocks.data.length+1:1},clearForm:function(){this.form.id="",this.form.label="",this.form.description="",this.form.post_id="",this.form.image="",this.form.position="",this.form.weight="",this.form.del_image=!1,this.imagePreview=""},handleUploadImage:function(){this.$refs.image.click()},handleRemoveImage:function(){this.imagePreview="",this.form.image="","edit"==this.formType&&(this.form.del_image=!0)},closeModal:function(){this.blockModal=!1,this.clearForm()},handleImagePreview:function(){var t=this,i=this.$refs.image.files[0];if(i){this.form.image=i;var e=new FileReader;e.onload=function(i){t.imagePreview=i.target.result},e.readAsDataURL(i)}}})},c=r,d=e("2877"),m=e("9989"),h=e("e359"),p=e("65c6"),f=e("9c40"),u=e("6ac5"),b=e("1c1c"),g=e("66e5"),k=e("4074"),q=e("0170"),v=e("b047"),_=e("74f7"),w=e("e669"),y=e("de5e"),P=e("24e8"),x=e("f09f"),B=e("a370"),C=e("27f9"),T=e("ddd8"),Q=e("9564"),I=e("0016"),M=e("4b7e"),A=e("eebe"),D=e.n(A),L=Object(d["a"])(c,o,a,!1,null,null,null);i["default"]=L.exports;D()(L,"components",{QPage:m["a"],QHeader:h["a"],QToolbar:p["a"],QBtn:f["a"],QToolbarTitle:u["a"],QList:b["a"],QItem:g["a"],QItemSection:k["a"],QItemLabel:q["a"],QChip:v["a"],QInnerLoading:_["a"],QSpinnerFacebook:w["a"],QPageSticky:y["a"],QDialog:P["a"],QCard:x["a"],QCardSection:B["a"],QInput:C["a"],QSelect:T["a"],QToggle:Q["a"],QIcon:I["a"],QCardActions:M["a"]})}}]);