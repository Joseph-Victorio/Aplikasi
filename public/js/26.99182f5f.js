(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[26],{"29d2":function(t,e,s){"use strict";s.r(e);s("b0c0");var i=function(){var t=this,e=t._self._c;return e("q-page",{attrs:{padding:""}},[e("q-header",{staticClass:"text-primary bg-white box-shadow"},[e("q-toolbar",[e("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"eva-arrow-back"},on:{click:t.handleBackButton}}),e("q-toolbar-title",{staticClass:"text-weight-bold brand"},[t._v("Form Order")])],1)],1),t.carts&&t.carts.items.length?e("div",{ref:"top",staticClass:"q-pb-xl",attrs:{id:"checkout"}},[e("shipping-address",{attrs:{isModalAddress:t.isAvailableOldAddress},on:{closeModal:function(e){t.isAvailableOldAddress=!1}}}),e("div",{},[e("fieldset",{staticClass:"q-mt-lg"},[e("legend",{staticClass:"q-pa-sm"},[t._v("Ringkasan Order")]),t.formOrder.items.length?e("div",{staticClass:"q-mb-md"},[e("q-separator"),e("q-list",{attrs:{separator:""}},[e("q-item",{staticClass:"bg-grey-1",attrs:{dense:""}},[e("q-item-section",[e("q-item-label",[t._v("Produk")])],1),e("q-item-section",{attrs:{side:""}},[e("q-item-label",[t._v("Subtotal")])],1)],1),t._l(t.formOrder.items,(function(s){return e("q-item",{key:s.id},[e("q-item-section",{attrs:{avatar:"",top:""}},[e("q-img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:s.image_url}})],1),e("q-item-section",[e("div",{staticClass:"col"},[e("div",{staticClass:"text-weight-medium"},[t._v(t._s(s.name))]),e("div",{staticClass:"text-caption text-grey-7"},[t._v(t._s(s.note))]),e("div",{staticClass:"text-grey-7"},[t._v(t._s(s.quantity+"X "+t.moneyIDR(s.price)))])])]),e("q-item-section",{attrs:{side:""}},[e("q-item-label",[t._v(t._s(t.moneyIDR(s.price*s.quantity)))])],1)],1)}))],2)],1):t._e(),e("q-separator"),e("div",{staticClass:"flex justify-end q-py-sm"},[e("table",{staticClass:"table dense"},[e("tr",[e("td",{attrs:{align:"right"}},[t._v("Jumlah")]),e("td",{attrs:{align:"right"}},[t._v(":")]),e("td",{attrs:{align:"right"}},[t._v(t._s(t.moneyIDR(t.formOrder.subtotal)))])]),e("tr",[e("td",{attrs:{align:"right"}},[t._v("Ongkos Kirim")]),e("td",{attrs:{align:"right"}},[t._v(":")]),e("td",{attrs:{align:"right"}},[t._v(t._s(t.formOrder.shipping_cost?t.moneyIDR(t.formOrder.shipping_cost):0))])]),e("tr",{staticStyle:{"border-bottom":"1px solid"}},[e("td",{attrs:{align:"right"}},[t._v("Total")]),e("td",{attrs:{align:"right"}},[t._v(":")]),e("td",{attrs:{align:"right"}},[t._v(t._s(t.moneyIDR(t.formOrder.total)))])])])]),t.formOrder.payment_fee?e("div",{staticClass:"flex justify-end q-mt-sm bg-grey-1 q-py-sm"},[e("table",{staticClass:"table dense"},[t.formOrder.payment_fee?e("tr",[e("td",{staticClass:"text-xs",attrs:{align:"right"}},[t._v("Payment Fee [ "+t._s(t.formOrder.payment_name)+" ]")]),e("td",{attrs:{align:"right"}},[t._v(":")]),e("td",{attrs:{align:"right"}},[t._v(t._s(t.moneyIDR(t.formOrder.payment_fee)))])]):t._e(),e("tr",[e("th",{attrs:{align:"right"}},[t._v("Total Tagihan")]),e("td",{attrs:{align:"right"}},[t._v(":")]),e("th",{attrs:{align:"right"}},[t._v(t._s(t.moneyIDR(t.formOrder.total+t.formOrder.payment_fee)))])])])]):t._e()],1)])],1):t._e(),e("q-footer",{staticClass:"bg-white q-pa-md"},[e("q-btn",{staticClass:"full-width q-mt-sm",attrs:{color:"green-6","no-caps":"",disable:t.stateLoading},on:{click:t.checkout}},[e("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 50 50",width:"20px",height:"20px"}},[e("g",{attrs:{id:"surface1441897"}},[e("path",{staticStyle:{stroke:"none","fill-rule":"nonzero",fill:"currentColor","fill-opacity":"1"},attrs:{d:"M 25 2 C 12.316406 2 2 12.316406 2 25 C 2 28.960938 3.023438 32.855469 4.964844 36.289062 L 2.035156 46.730469 C 1.941406 47.074219 2.035156 47.441406 2.28125 47.695312 C 2.472656 47.894531 2.734375 48 3 48 C 3.078125 48 3.160156 47.988281 3.238281 47.972656 L 14.136719 45.273438 C 17.464844 47.058594 21.210938 48 25 48 C 37.683594 48 48 37.683594 48 25 C 48 12.316406 37.683594 2 25 2 Z M 36.570312 33.117188 C 36.078125 34.476562 33.71875 35.722656 32.585938 35.886719 C 31.566406 36.035156 30.277344 36.101562 28.863281 35.65625 C 28.007812 35.386719 26.90625 35.027344 25.496094 34.429688 C 19.574219 31.902344 15.707031 26.011719 15.410156 25.625 C 15.117188 25.234375 13 22.464844 13 19.59375 C 13 16.726562 14.523438 15.3125 15.066406 14.730469 C 15.609375 14.144531 16.246094 14 16.640625 14 C 17.035156 14 17.429688 14.003906 17.773438 14.019531 C 18.136719 14.039062 18.625 13.882812 19.101562 15.023438 C 19.59375 16.191406 20.777344 19.058594 20.921875 19.351562 C 21.070312 19.644531 21.167969 19.984375 20.972656 20.375 C 20.777344 20.761719 20.679688 21.007812 20.382812 21.347656 C 20.085938 21.6875 19.761719 22.105469 19.496094 22.367188 C 19.199219 22.660156 18.894531 22.976562 19.238281 23.558594 C 19.582031 24.144531 20.765625 26.050781 22.523438 27.597656 C 24.777344 29.585938 26.679688 30.199219 27.269531 30.492188 C 27.859375 30.785156 28.203125 30.734375 28.550781 30.347656 C 28.894531 29.957031 30.023438 28.644531 30.417969 28.058594 C 30.8125 27.476562 31.203125 27.574219 31.746094 27.769531 C 32.289062 27.960938 35.191406 29.371094 35.78125 29.664062 C 36.371094 29.957031 36.765625 30.101562 36.914062 30.34375 C 37.0625 30.585938 37.0625 31.753906 36.570312 33.117188 Z M 36.570312 33.117188 "}})])]),e("span",{staticClass:"q-ml-sm"},[t._v("\n        "+t._s(t.isOk?"Proses Order":"Lengkapi data untuk Order")+"\n      ")])])],1)],1)},r=[],a=(s("ac1f"),s("5319"),s("2ca0"),s("1276"),s("a15b"),s("caad"),s("b64b"),s("d3b7"),s("e6cf"),s("a79d"),s("159b"),s("99af"),s("a4d3"),s("e01a"),function(){var t=this,e=t._self._c;return e("div",{},[e("div",{ref:"courier",staticClass:"q-mb-lg",attrs:{id:"courier"}},[t.config.can_cod?e("div",[e("div",{staticClass:"text-md text-weight-medium"},[t._v("Pilih Metode Pengiriman")]),e("div",{staticClass:"q-py-sm q-gutter-x-sm"},[e("q-radio",{attrs:{val:"EKSPEDISI",label:"Via Ekspedisi"},model:{value:t.shipping_method,callback:function(e){t.shipping_method=e},expression:"shipping_method"}}),e("q-radio",{attrs:{val:"COD",label:"Via Kurir Toko ( COD )"},model:{value:t.shipping_method,callback:function(e){t.shipping_method=e},expression:"shipping_method"}})],1)]):t._e(),e("div",{staticClass:"q-mt-md",attrs:{id:"shipping_destination"}},["EKSPEDISI"==t.shipping_method&&t.config.can_shipping?e("div",[e("div",{attrs:{id:"shipping"}},[e("div",{staticClass:"text-md text-weight-medium"},[t._v("Pilih Kecamatan Tujuan")]),e("div",{staticClass:"q-mt-sm"},[t.formOrder.shipping_destination?e("q-list",[e("q-item",{staticClass:"bg-grey-2 q-px-sm"},[e("q-item-section",[t._v(t._s(t.destinationAddressFormat(t.formOrder.shipping_destination)))]),e("q-item-section",{attrs:{side:""}},[e("q-btn",{attrs:{icon:"edit",dense:"",unelevated:"","no-caps":"",color:"primary",size:"12px"},on:{click:t.clearAddress}})],1)],1)],1):e("div",[e("q-input",{ref:"search",attrs:{filled:"",square:"",placeholder:"Ketik kecamatan tujuan, min 3 karakter",debounce:"500",loading:t.isSearching,error:t.errors.shipping_destination},on:{input:t.findSubdistrict},model:{value:t.searchSubdistrictKey,callback:function(e){t.searchSubdistrictKey=e},expression:"searchSubdistrictKey"}}),e("transition",{attrs:{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.isSearching||t.searchReady,expression:"isSearching || searchReady"}],staticClass:"relative bg-grey-1"},[t.searchAvailable?e("q-list",{staticStyle:{"min-height":"43px","max-height":"300px","overflow-y":"auto"}},t._l(t.subdistrictOptionsData,(function(s){return e("q-item",{key:s.id,attrs:{clickable:""},on:{click:function(e){return t.selectSubdistrict(s)}}},[e("q-item-section",[e("q-item-label",[t._v(t._s(t.destinationAddressFormat(s)))])],1)],1)})),1):e("div",{staticClass:"text-red-7 q-pa-md"},[t._v("kecamatan "+t._s(t.searchSubdistrictKey)+" tidak ditemukan")]),e("q-inner-loading",{attrs:{showing:t.isSearching}})],1)])],1)],1)]),e("div",{staticClass:"relative q-mt-md"},[e("div",{staticClass:"text-md text-weight-medium q-pb-xs"},[t._v("Pilih Kurir")]),e("q-select",{attrs:{id:"inputCourier",filled:"",square:"","stack-label":"",label:"Pilih Kurir",options:t.couriers,error:t.errors.shipping_courier_service},on:{input:t.selectCourier},scopedSlots:t._u([{key:"error",fn:function(){return[t._v("Kurir belum dipilih")]},proxy:!0}],null,!1,3726639e3),model:{value:t.currentSelelectedCourier,callback:function(e){t.currentSelelectedCourier=e},expression:"currentSelelectedCourier"}})],1),t.shippingCost.ready?e("q-list",[t.shippingCost.costs.length?t._l(t.shippingCost.costs,(function(s){return e("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:s.service,staticClass:"bg-grey-1",attrs:{clickable:""},on:{click:function(e){return t.selectCost(s)}}},[e("q-item-section",{attrs:{avatar:""}},[e("q-icon",{attrs:{name:t.isSelectedCost&&t.isSelectedCost.service==s.service?"radio_button_checked":"radio_button_unchecked",color:t.isSelectedCost&&t.isSelectedCost.service==s.service?"primary":"grey-6"}})],1),e("q-item-section",[e("q-item-label",[t._v("Layanan : "+t._s(s.service))]),e("q-item-label",[t._v("Ongkos kirim : "+t._s(t.moneyIDR(s.cost[0].value)))]),e("q-item-label",{attrs:{caption:""}},[t._v(t._s(s.description)+" "),s.cost[0].etd?e("span",[t._v("Estimasi "+t._s(s.cost[0].etd)+" day")]):t._e()])],1)],1)})):e("q-item",[e("q-item-section",[e("q-item-label",{staticClass:"text-red-5 q-pa-lg"},[t._v("Ongkos kirim tidak ditemukan, silahkan ganti dengan kurir yang\n                lain")])],1)],1)],2):t._e(),e("div",{ref:"courier_skeleton"},[t.loading?e("q-list",t._l(3,(function(t){return e("q-item",{key:t},[e("q-item-section",{attrs:{avatar:"",top:""}},[e("div",{staticClass:"q-pa-sm"},[e("q-skeleton",{staticClass:"round",attrs:{width:"20px",height:"20px"}})],1)]),e("q-item-section",[e("q-skeleton",{attrs:{type:"text",width:"80px"}}),e("q-skeleton",{attrs:{type:"text",width:"180px"}}),e("q-skeleton",{attrs:{type:"text",width:"110px"}}),e("q-skeleton",{attrs:{type:"text",width:"90px"}})],1)],1)})),1):t._e()],1)],1):t._e(),"COD"==t.shipping_method&&t.config.can_cod?e("div",[e("div",{staticClass:"q-mb-lg"},[e("div",{staticClass:"text-md q-pb-xs text-weight-medium q-mb-xs"},[t._v("Pilih Tujuan Pengiriman")]),e("q-select",{attrs:{filled:"",options:t.listCodOptions,label:"Pilih",error:t.errors.shipping_destination},scopedSlots:t._u([{key:"error",fn:function(){return[t._v("Tujuan pengiriman belum diisi")]},proxy:!0},{key:"option",fn:function(s){return[e("q-list",{attrs:{separator:""}},[e("q-item",t._g(t._b({},"q-item",s.itemProps,!1),s.itemEvents),[e("q-item-section",[e("q-item-label",[t._v(t._s(s.opt.label))]),e("q-item-label",{staticClass:"text-primary text-weight-bold text-sm"},[t._v(" Ongkos Kirim "+t._s(s.opt.price>0?t.moneyIDR(s.opt.price):"Gratis"))])],1)],1)],1)]}}],null,!1,645001243),model:{value:t.codSelected,callback:function(e){t.codSelected=e},expression:"codSelected"}})],1)]):t._e()])]),e("div",{staticClass:"q-pb-lg",attrs:{id:"customer"}},[e("div",{staticClass:"text-md q-pb-xs text-weight-medium"},[t._v("Detail Penerima")]),e("div",{staticClass:"q-gutter-y-md"},[e("q-input",{attrs:{filled:"",square:"","stack-label":"",label:"Nama Penerima",error:t.errors.customer_name,debounce:"1000"},model:{value:t.customer_name,callback:function(e){t.customer_name=e},expression:"customer_name"}}),t.canEmail?e("q-input",{attrs:{filled:"",square:"","stack-label":"",type:"email",required:"",label:"Alamat Email",error:t.errors.customer_email,debounce:"1000"},model:{value:t.customer_email,callback:function(e){t.customer_email=e},expression:"customer_email"}}):t._e(),e("q-input",{attrs:{label:"No ponsel / Whatsapp",filled:"",square:"","stack-label":"",type:"number",error:t.errors.customer_phone,debounce:"1000"},model:{value:t.customer_phone,callback:function(e){t.customer_phone=e},expression:"customer_phone"}}),e("div",[e("q-input",{staticClass:"preline",attrs:{label:"Alamat Lengkap",type:"textarea",filled:"",rows:"4",square:"","stack-label":"",error:t.errors.customer_address},model:{value:t.customer_address,callback:function(e){t.customer_address=e},expression:"customer_address"}}),e("div",{staticClass:"flex justify-between items-center q-mt-sm"},[e("div",[t.user&&t.user.address.length?e("q-btn",{attrs:{"no-caps":"",label:"Pilih Alamat",size:"sm",color:"primary",unelevated:""},on:{click:function(e){t.addressModal=!0}}}):t._e()],1)])],1)],1)]),e("q-dialog",{model:{value:t.useDataUserPrompt,callback:function(e){t.useDataUserPrompt=e},expression:"useDataUserPrompt"}},[e("q-card",{staticStyle:{"max-width":"400px"}},[e("q-card-section",[e("div",{staticStyle:{"font-size":"17px","font-weight":"500","margin-bottom":"6px"}},[t._v("Halo kak,")]),e("div",[t._v("Kami menemukan data alamat tersimpan dari order sebelumnya. Apakah akan menggunakan data tersebut?")])]),e("q-card-actions",{staticClass:"justify-end"},[e("q-btn",{attrs:{size:"12px",outline:"",color:"primary",label:"Tidak"},on:{click:t.closeModalAddress}}),e("q-btn",{attrs:{size:"12px",unelevated:"",color:"primary",label:"Ya Gunakan"},on:{click:t.setDataUser}})],1)],1)],1),e("q-dialog",{model:{value:t.addressModal,callback:function(e){t.addressModal=e},expression:"addressModal"}},[e("q-card",[t.user&&t.user.address.length?e("q-card-section",[e("div",{staticClass:"card-title flex justify-between"},[e("div",[t._v("Pilih Alamat")]),e("div",{staticClass:"q-gutter-x-sm"},[e("q-btn",{attrs:{label:"Tambah",flat:"",dense:""},on:{click:t.handleAddAddress}}),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",flat:"",dense:""}})],1)]),e("q-list",t._l(t.user.address,(function(s){return e("q-item",{key:s.id,attrs:{clickable:""},on:{click:function(e){return t.selectAddress(s)}}},[e("q-item-section",{attrs:{avatar:""}},[e("q-icon",{attrs:{name:t.customer_address_selected==s.id?"eva-checkmark-square-2-outline":"eva-square-outline",color:t.customer_address_selected==s.id?"green":"grey-8",size:"md"}})],1),e("q-item-section",[e("q-item-label",{staticClass:"row items-center q-gutter-x-sm"},[e("div",[t._v(t._s(s.label)+" ")]),s.is_primary?e("q-badge",{attrs:{color:"green",label:"Utama"}}):t._e()],1),e("q-item-label",{staticClass:"q-pt-xs",attrs:{caption:""}},[t._v(t._s(s.address))])],1)],1)})),1)],1):t._e()],1)],1),e("q-dialog",{attrs:{persistent:""},model:{value:t.formAddressModal,callback:function(e){t.formAddressModal=e},expression:"formAddressModal"}},[e("q-card",{staticClass:"card-lg"},[t.user&&t.user.address.length?e("q-card-section",[e("div",{staticClass:"card-title flex justify-between"},[e("div",[t._v("Tambah Alamat")]),e("div",{staticClass:"q-gutter-x-sm"},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",dense:""}})],1)]),e("form",{staticClass:"q-gutter-y-md",on:{submit:function(e){return e.preventDefault(),t.submitNewAddress.apply(null,arguments)}}},[e("q-input",{attrs:{required:"",label:"Label",placeholder:"eg: Kantor"},model:{value:t.formAddress.label,callback:function(e){t.$set(t.formAddress,"label",e)},expression:"formAddress.label"}}),e("q-input",{attrs:{required:"",type:"textarea",label:"Alamat Lengkap"},model:{value:t.formAddress.address,callback:function(e){t.$set(t.formAddress,"address",e)},expression:"formAddress.address"}}),e("q-checkbox",{attrs:{label:"Gunakan sebagai alamat utama"},model:{value:t.formAddress.is_primary,callback:function(e){t.$set(t.formAddress,"is_primary",e)},expression:"formAddress.is_primary"}}),e("div",{staticClass:"card-action"},[e("q-btn",{staticClass:"full-width",attrs:{label:"Simpan Alamat",color:"primary",type:"submit"}})],1)],1)]):t._e()],1)],1)],1)}),o=[],n=s("448a"),c=s.n(n),d=s("ded3"),l=s.n(d),m=(s("d81d"),s("fb6a"),s("7db0"),s("758b")),u={name:"ShippingAddress",props:{canEmail:{type:Boolean,default:!1}},data:function(){return{formAddressModal:!1,addressModal:!1,costNotFound:!1,readyAddressBlock:!1,useDataUserPrompt:!1,isSelectedCost:null,isSelectedCostCod:null,formGetCost:{origin:"",destination:"",weight:"",courier:""},shippingCost:{code:"",name:"",costs:[],ready:!1},address_street:"",userAddressData:{destination:"",address:""},searchSubdistrictKey:"",isSearching:!1,searchAvailable:!0,searchReady:!1,subdistrictOptionsData:[],codSelected:"",currentSelelectedCourier:null,formAddress:{label:"",is_primary:!1,address:""}}},watch:{shipping_method:function(t){t&&(this.clearShipping(),this.clearPayment(),this.clearAddress(),this.codSelected="",this.isSelectedCostCod="")},codSelected:function(t){t&&(this.commitFormOrder("shipping_cost",t.price),this.commitFormOrder("shipping_courier_name","COD"),this.commitFormOrder("shipping_courier_service","Diantar kurir toko"),this.commitFormOrder("shipping_destination",t))}},computed:{customer_address:{set:function(t){this.commitFormOrder("customer_address",t)},get:function(){return this.$store.state.order.formOrder.customer_address}},customer_address_selected:{set:function(t){this.commitFormOrder("customer_address_selected",t)},get:function(){return this.$store.state.order.formOrder.customer_address_selected}},customer_phone:{set:function(t){this.commitFormOrder("customer_phone",t)},get:function(){return this.$store.state.order.formOrder.customer_phone}},customer_name:{set:function(t){this.commitFormOrder("customer_name",t)},get:function(){return this.$store.state.order.formOrder.customer_name}},customer_email:{set:function(t){this.commitFormOrder("customer_email",t)},get:function(){return this.$store.state.order.formOrder.customer_email}},shipping_method:{set:function(t){this.commitFormOrder("shipping_method",t)},get:function(){return this.$store.state.order.formOrder.shipping_method}},listCodOptions:function(){return this.config&&this.config.can_cod?this.config.cod_list.map((function(t){return l()({label:"".concat(t.subdistrict_name," ").concat(t.type," ").concat(t.city," ").concat(t.province),value:t.id},t)})):[]},canCod:function(){return!(!this.config||!this.config.cod_list.length)},codListString:function(){if(this.canCod){var t=this.config.cod_list.map((function(t){return t.subdistrict_name}));if(t.length>1){var e=t.slice(0,t.length-1).join(", ");return e+" atau "+t[t.length-1]}return t.join(", ")}return""},errors:function(){return this.$store.state.errors},formOrder:function(){return this.$store.state.order.formOrder},user:function(){return this.$store.state.user.user},originAddressFormat:function(){return"".concat(this.config.warehouse_address.city,", ").concat(this.config.warehouse_address.province)},couriers:function(){var t=[{label:"Pilih",value:""}];return this.config&&(t=[].concat(c()(t),c()(this.config.rajaongkir_couriers))),t},config:function(){return this.$store.state.config},carts:function(){return this.$store.state.cart.carts},loading:function(){return this.$store.state.loading},canGetCost:function(){return!!(this.formGetCost.destination&&this.formGetCost.courier&&this.formGetCost.weight&&this.formGetCost.origin)},codItem:function(){var t=this;if(this.formOrder.shipping_destination){if(this.config&&this.config.cod_list&&this.config.cod_list.length){var e=this.config.cod_list.find((function(e){return e.subdistrict_id==t.formOrder.shipping_destination.subdistrict_id}));return void 0!=e?e:null}return null}return null},codAvailable:function(){var t=[];return this.config.cod_list.length&&this.config.cod_list.forEach((function(e){t.push("".concat(e.subdistrict_name))})),t.join(", ")}},mounted:function(){this.setFormGetCost(),this.user&&(this.commitFormOrder("user_id",this.user.id),this.customer_name=this.user.name,this.customer_email=this.user.email,this.customer_phone=this.user.phone?this.user.phone:"",this.user.address.length?this.selectPrimaryAddress():this.commitFormOrder("is_save_address",!0)),localStorage.getItem("_nex_user_data")&&(this.customer_name&&this.customer_phone||(this.useDataUserPrompt=!0)),this.config&&!this.config.can_shipping&&(this.shipping_method="COD")},methods:{submitNewAddress:function(){var t=this;Object(m["a"])().post("user-address",this.formAddress).then((function(){t.$store.dispatch("user/getUser"),setTimeout((function(){t.addressModal=!0}),500)})),this.formAddressModal=!1},handleAddAddress:function(){this.formAddress.label="",this.formAddress.is_primary=!1,this.formAddress.address="",this.addressModal=!1,this.formAddressModal=!0},removeSelectedAddress:function(){this.customer_address_selected=null,this.customer_address=""},selectPrimaryAddress:function(){var t=this.user.address.find((function(t){return 1==t.is_primary}));void 0==t&&(t=this.user.address[0]),this.selectAddress(t)},selectAddress:function(t){this.customer_address_selected=t.id,this.customer_address=t.address,this.is_save_address=!1},clearShipping:function(){this.commitFormOrder("shipping_courier_name",""),this.commitFormOrder("shipping_courier_service",""),this.commitFormOrder("shipping_cost",0)},clearPayment:function(){this.commitFormOrder("payment_method",""),this.commitFormOrder("payment_name",""),this.commitFormOrder("payment_type",""),this.commitFormOrder("payment_code",""),this.commitFormOrder("payment_fee",0),this.$emit("removePayment")},commitFormOrder:function(t,e){this.$store.commit("order/SET_FORM_ORDER",{key:t,value:e}),this.saveDataUser()},destinationAddressFormat:function(t){return"".concat(t.subdistrict_name," - ").concat(t.type," ").concat(t.city,", ").concat(t.province)},selectCostCod:function(t){this.isSelectedCost=null,this.commitFormOrder("shipping_courier_name","COD"),this.commitFormOrder("shipping_courier_service","COD"),this.commitFormOrder("shipping_cost",t.price?parseInt(t.price):0),this.isSelectedCostCod=t},selectCost:function(t){this.isSelectedCostCod=null,this.isSelectedCost=t,this.commitFormOrder("shipping_courier_name",this.shippingCost.name),this.commitFormOrder("shipping_courier_service",t.service),this.commitFormOrder("shipping_cost",t.cost[0].value)},changeNewAddress:function(){this.clearAddress(),this.formGetCost.courier="",this.formGetCost.destination="",this.readyAddressBlock=!1,this.clearSelectedCost()},closeModalAddress:function(){this.changeNewAddress(),this.useDataUserPrompt=!1,this.$emit("closeModal")},clearAddress:function(){this.currentSelelectedCourier=null,this.searchSubdistrictKey="",this.subdistrictOptionsData=[],this.searchReady=!1,this.formGetCost.destination="",this.formGetCost.courier="",this.clearSelectedCost(),this.commitFormOrder("shipping_destination","")},selectSubdistrict:function(t){this.commitFormOrder("shipping_destination",t),this.searchSubdistrictKey="",this.formGetCost.origin=this.config.warehouse_address.city_id,this.formGetCost.destination=t.city_id,this.formGetCost.weight=this.formOrder.weight,this.userAddressData.destination=t,"pro"==this.config.rajaongkir_type&&(this.formGetCost.origin=this.config.warehouse_address.subdistrict_id,this.formGetCost.destination=t.subdistrict_id,this.formGetCost.destinationType="subdistrict",this.formGetCost.originType="subdistrict"),this.getCost()},findSubdistrict:function(){var t=this;this.subdistrictOptionsData=[],this.searchAvailable=!0,this.searchReady=!1,this.searchSubdistrictKey.length<3||(this.isSearching=!0,Object(m["a"])().get("searchAddress/"+this.searchSubdistrictKey).then((function(e){200==e.status&&(e.data.success?(t.subdistrictOptionsData=e.data.results,t.searchAvailable=!!e.data.results.length):t.$q.notify({type:"negative",message:e.data.message}))})).finally((function(){t.isSearching=!1,t.searchReady=!0})))},setDataUser:function(){var t=JSON.parse(localStorage.getItem("_nex_user_data"));this.config.can_shipping&&this.selectSubdistrict(t.shipping_destination),this.customer_address=t.customer_address,this.customer_name=t.customer_name,this.customer_phone=t.customer_phone,this.customer_email=t.customer_email?t.customer_email:"",this.useDataUserPrompt=!1,this.readyAddressBlock=!0},saveDataUser:function(){if(this.formOrder.customer_name&&this.formOrder.customer_phone&&this.formOrder.customer_address&&this.formOrder.shipping_destination){var t={customer_name:this.formOrder.customer_name,customer_phone:this.formOrder.customer_phone,customer_email:this.formOrder.customer_email,customer_address:this.formOrder.customer_address,shipping_destination:this.formOrder.shipping_destination};localStorage.setItem("_nex_user_data",JSON.stringify(t))}},selectCourier:function(t){t||(this.clearSelectedCost(),this.formGetCost.courier=""),"cod"==t?this.clearSelectedCost():(this.commitFormOrder("shipping_courier_name",this.currentSelelectedCourier.label),this.formGetCost.courier=this.currentSelelectedCourier.value,this.getCost())},clearSelectedCost:function(){this.shippingCost.code="",this.shippingCost.name="",this.shippingCost.costs=[],this.shippingCost.ready=!1,this.isSelectedCost=null,this.isSelectedCostCod=null,this.clearShipping()},getCost:function(){var t=this;this.setFormGetCost(),"COD"!=this.shipping_method&&(this.shippingCost.ready=!1,this.costNotFound=!1,this.clearSelectedCost(),this.canGetCost&&(this.jumpTo("shipping"),this.$store.commit("SET_LOADING",!0),Object(m["a"])().post("shipping/costs",this.formGetCost).then((function(e){if(200==e.status){var s=e.data.results.data[0];t.shippingCost.code=s.code,t.shippingCost.name=s.name,t.shippingCost.costs=s.costs,s.costs.length||(t.costNotFound=!0),t.$store.commit("SET_LOADING",!1)}})).catch((function(){t.$store.commit("SET_LOADING",!1),t.costNotFound=!0})).finally((function(){t.shippingCost.ready=!0}))))},setFormGetCost:function(){this.formGetCost.weight=this.formOrder.weight,this.formOrder.shipping_destination&&(this.formGetCost.destination=this.formOrder.shipping_destination.city_id),this.config&&this.config.can_shipping&&(this.formGetCost.origin=this.config.warehouse_address.city_id,"pro"==this.config.rajaongkir_type&&(this.formGetCost.origin=this.config.warehouse_address.subdistrict_id,this.formGetCost.destinationType="subdistrict",this.formGetCost.originType="subdistrict",this.formOrder.shipping_destination&&(this.formGetCost.destination=this.formOrder.shipping_destination.subdistrict_id)))}}},h=u,p=s("2877"),f=s("3786"),_=s("1c1c"),g=s("66e5"),v=s("4074"),b=s("9c40"),C=s("27f9"),y=s("0170"),q=s("74f7"),O=s("ddd8"),k=s("0016"),S=s("293e"),x=s("8f8e"),A=s("24e8"),w=s("f09f"),D=s("a370"),F=s("4b7e"),I=s("58a81"),$=s("714f"),G=s("7f67"),R=s("eebe"),P=s.n(R),T=Object(p["a"])(h,a,o,!1,null,null,null),Q=T.exports;P()(T,"components",{QRadio:f["a"],QList:_["a"],QItem:g["a"],QItemSection:v["a"],QBtn:b["a"],QInput:C["a"],QItemLabel:y["a"],QInnerLoading:q["a"],QSelect:O["a"],QIcon:k["a"],QSkeleton:S["a"],QCheckbox:x["a"],QDialog:A["a"],QCard:w["a"],QCardSection:D["a"],QCardActions:F["a"],QBadge:I["a"]}),P()(T,"directives",{Ripple:$["a"],ClosePopup:G["a"]});var j={components:{ShippingAddress:Q},name:"CheckoutDirectWithShipping",data:function(){return{isAvailableOldAddress:!1}},computed:{carts:function(){return this.$store.getters["cart/getCarts"]},formOrder:function(){return this.$store.getters["order/getFormOrder"]},errors:function(){return this.$store.state.errors},isOk:function(){return!!(this.formOrder.customer_name&&this.formOrder.customer_phone&&this.formOrder.shipping_courier_name&&this.formOrder.customer_address)}},mounted:function(){this.carts.items.length||this.$router.back(),this.checkDataUser(),this.collectOrder()},methods:{collectOrder:function(){this.$store.commit("order/COLLECT_ORDER",this.carts)},checkDataUser:function(){localStorage.getItem("user_data")&&(this.isAvailableOldAddress=!0)},handleBackButton:function(){this.$router.push({name:"Cart"})},formatPhoneNumber:function(t){var e=t.replace(/\D/g,"");return e.startsWith("0")&&(e="62"+e.substr(1)),e},getRoutePath:function(t){var e=this.$router.resolve({name:"UserInvoice",params:{order_ref:t}});return location.origin+e.href},formatAddressCod:function(t){var e=t.split("<br>");return e.join("\n")},validateData:function(){this.$store.commit("CLEAR_ERRORS");var t=["customer_name","customer_phone","customer_address"],e=["shipping_destination","shipping_courier_name","shipping_courier_service"];for(var s in this.formOrder)(t.includes(s)||e.includes(s))&&(this.formOrder[s]&&""!=this.formOrder[s]||this.$store.commit("PUSH_ERRORS",{key:s,value:!0}));if(Object.keys(this.errors).length>0){for(var i in this.errors){if("shipping_destination"==i)return this.jumpTo("shipping"),this.$q.notify({type:"negative",message:"Tujuan pengiriman belum diisi"}),!1;if("shipping_courier_service"==i)return this.jumpTo("courier"),this.$q.notify({type:"negative",message:"Kurir belum dipilih"}),!1;if(t.includes(i))return this.jumpTo("customer"),this.$q.notify({type:"negative",message:"Data penerima belum lengkap"}),!1}return!1}return!0},checkout:function(){var t=this;this.validateData()&&this.isOk&&(this.$store.commit("SET_LOADING",!0),this.$q.loading.show({message:"Order sedang diproses. Silahkan tunggu..."}),this.$store.dispatch("order/storeOrder",this.formOrder).then((function(e){if(200==e.status){var s=e.data.results;setTimeout((function(){t.$router.push({name:"UserInvoice",params:{order_ref:s.order_ref}})}),500),t.redirectWhatsapp(s)}})).catch((function(){t.$q.loading.hide()})).finally((function(){setTimeout((function(){t.$store.commit("SET_LOADING",!1)}),3e3)})))},redirectWhatsapp:function(t){var e=this,s=this.getRoutePath(t.order_ref),i="https://api.whatsapp.com";this.$q.platform.is.desktop&&(i="https://web.whatsapp.com");var r=this.formatPhoneNumber(this.currentShop.phone),a="Halo kak, saya mau order:\n\n",o=this.formOrder.items,n=1;o.forEach((function(t){a+="*".concat(n,"). ").concat(t.name,"*\n"),t.note&&(a+="".concat(t.note,"\n")),a+="Qty: ".concat(t.quantity,"\nHarga (@): ").concat(e.moneyIDR(t.price),"\nHarga Total: ").concat(e.moneyIDR(t.quantity*t.price),"\n\n"),n++})),a+="Subtotal: *".concat(this.moneyIDR(this.formOrder.subtotal),"*\n"),a+="Ongkir: *".concat(this.moneyIDR(this.formOrder.shipping_cost),"*\n"),a+="Total: *".concat(this.moneyIDR(this.formOrder.total),"*\n"),a+="-----------------------------------\n\n",a+="*Nama:*\n ".concat(this.formOrder.customer_name," (").concat(this.formOrder.customer_phone,")\n\n"),a+="*Alamat:*\n".concat(this.formatAddressCod(this.formOrder.customer_address),"\n\n"),a+="Kurir: ".concat(this.formOrder.shipping_courier_name,"\n"),a+="Servis: ".concat(this.formOrder.shipping_courier_service,"\n\n"),a+="Ref Order: ".concat(s,"\n");var c=i+"/send?phone="+r+"&text="+encodeURI(a);setTimeout((function(){e.$q.loading.hide()}),1e3),setTimeout((function(){e.$store.dispatch("cart/clearCart",e.currentSessionId)}),5e3),window.open(c,"_blank")}}},E=j,N=s("9989"),K=s("e359"),M=s("65c6"),L=s("6ac5"),U=s("eb85"),B=s("068f"),z=s("7ff0"),H=Object(p["a"])(E,i,r,!1,null,null,null);e["default"]=H.exports;P()(H,"components",{QPage:N["a"],QHeader:K["a"],QToolbar:M["a"],QBtn:b["a"],QToolbarTitle:L["a"],QSeparator:U["a"],QList:_["a"],QItem:g["a"],QItemSection:v["a"],QItemLabel:y["a"],QImg:B["a"],QFooter:z["a"]})}}]);