(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[38],{ab69:function(t,e,s){"use strict";s.r(e);var o=function(){var t=this,e=t._self._c;return e("q-page",[e("q-header",[e("q-toolbar",[e("q-btn",{attrs:{to:{name:"Settings"},flat:"",round:"",dense:"",icon:"eva-arrow-back"}}),e("q-toolbar-title",[t._v("\n       Diskon / Kupon\n      ")])],1)],1),e("q-tabs",{staticClass:"text-primary",model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[e("q-tab",{attrs:{name:"promo",label:"Promo"}}),e("q-tab",{attrs:{name:"kupon",label:"Kupon"}}),e("q-tab",{attrs:{name:"diskon",label:"Diskon"}})],1),e("q-separator"),e("q-tab-panels",{attrs:{animated:""},model:{value:t.tab,callback:function(e){t.tab=e},expression:"tab"}},[e("q-tab-panel",{staticClass:"q-px-xs",attrs:{name:"diskon"}},[e("Discount")],1),e("q-tab-panel",{staticClass:"q-px-xs",attrs:{name:"kupon"}},[e("Coupon")],1),e("q-tab-panel",{staticClass:"q-px-xs",attrs:{name:"promo"}},[e("Promote")],1)],1)],1)},a=[],i=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"row items-center justify-between q-px-sm"},[e("div",{staticClass:"text-h6"},[t._v("Master Diskon")]),e("q-btn",{attrs:{unelevated:"",color:"primary"},on:{click:t.handleAddDiscount}},[e("q-icon",{attrs:{name:"add"}}),e("span",[t._v("Diskon")])],1)],1),e("div",{staticClass:"q-py-md"},[e("q-list",{attrs:{separator:""}},[e("q-item",[e("q-item-section",{attrs:{side:""}},[t._v("#")]),e("q-item-section",[t._v("Label")]),e("q-item-section",[t._v("Nilai")]),e("q-item-section",{attrs:{side:""}},[t._v("Action")])],1),t._l(t.discounts,(function(s,o){return e("q-item",{key:o},[e("q-item-section",{attrs:{side:""}},[t._v(t._s(o+1))]),e("q-item-section",[t._v(t._s(s.label))]),e("q-item-section",["percent"==s.unit?e("q-item-label",[t._v("\n           "+t._s(s.value)+" %\n         ")]):e("q-item-label",[t._v("\n           "+t._s(t.moneyIDR(s.value))+"\n         ")])],1),e("q-item-section",{attrs:{side:""}},[e("div",{staticClass:"q-gutter-sm"},[e("q-btn",{attrs:{size:"sm",unelevated:"",color:"red",icon:"eva-trash-2",round:""},on:{click:function(e){return t.handleDeleteDiscount(s.id)}}}),e("q-btn",{attrs:{size:"sm",unelevated:"",color:"blue",icon:"eva-edit-2",round:""},on:{click:function(e){return t.handleEditDiscount(s)}}})],1)])],1)}))],2)],1),e("q-dialog",{attrs:{persistent:""},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[e("q-card",{staticClass:"card-medium"},[e("div",{staticClass:"card-heading"},[t._v(t._s(t.formType)+" Diskon")]),e("form",{on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[e("q-card-section",[e("q-input",{attrs:{required:"",filled:"",square:"",label:"Label",rules:[function(t){return!!t||"Field is required"}]},model:{value:t.form.label,callback:function(e){t.$set(t.form,"label",e)},expression:"form.label"}}),e("div",{staticClass:"flex items-center q-mt-sm"},[e("q-input",{attrs:{required:"",filled:"",square:"",label:"Amount",rules:[function(t){return!!t||"Field is required"}]},model:{value:t.form.value,callback:function(e){t.$set(t.form,"value",e)},expression:"form.value"}}),e("q-select",{attrs:{required:"",filled:"",square:"",label:"Unit",options:t.options,"emit-value":"","map-options":"",rules:[function(t){return!!t||"Field is required"}]},model:{value:t.form.unit,callback:function(e){t.$set(t.form,"unit",e)},expression:"form.unit"}})],1),e("div",{staticClass:"flex items-center justify-end q-mt-md q-gutter-x-sm"},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Batal"}}),e("q-btn",{attrs:{unelevated:"",color:"primary",type:"submit",label:"Simpan"}})],1)],1)],1)])],1)],1)},n=[],r=s("ded3"),l=s.n(r),c=(s("4de4"),s("2f62")),u={name:"DiscountBlock",data:function(){return{modal:!1,options:[{value:"percent",label:"Percent"},{value:"amount",label:"Amount"}],form:{label:"",unit:"percent",value:0},selectedDiscount:null,formType:"Tambah"}},computed:l()({},Object(c["e"])({discounts:function(t){return t.discount.discounts},coupons:function(t){return t.coupon.coupons},promotes:function(t){return t.promo.promotes}})),methods:l()(l()({},Object(c["b"])("discount",["getDiscounts","storeDiscount","updateDiscount","deleteDiscount"])),{},{handleAddDiscount:function(){this.clearForm(),this.formType="Tambah",this.modal=!0},handleEditDiscount:function(t){this.clearForm(),this.formType="Edit",this.selectedDiscount=t,this.setInputData(),this.modal=!0},handleDeleteDiscount:function(t){var e=this,s=this.coupons.filter((function(e){return e.discount_id==t}));if(s.length)this.$q.notify({type:"negative",message:"Gagal! Diskon terasosiasi dengan kupon"});else{var o=this.promotes.filter((function(e){return e.discount_id==t}));o.length?this.$q.notify({type:"negative",message:"Gagal! Diskon terasosiasi dengan promo"}):this.$q.dialog({message:"Yakin akan menghapus ini?",cancel:!0}).onOk((function(){e.deleteDiscount(t)}))}},setInputData:function(){this.form.label=this.selectedDiscount.label,this.form.unit=this.selectedDiscount.unit,this.form.value=this.selectedDiscount.value},submit:function(){var t=this,e=this.form;"Edit"==this.formType&&(e._method="PUT",e.id=this.selectedDiscount.id,this.updateDiscount(e).then((function(){t.closeModal()}))),"Tambah"==this.formType&&this.storeDiscount(e).then((function(){t.closeModal()}))},closeModal:function(){this.clearForm(),this.modal=!1},clearForm:function(){this.form.label="",this.form.unit="percent",this.form.value=0}}),mounted:function(){this.getDiscounts()}},d=u,m=s("2877"),p=s("9c40"),f=s("0016"),h=s("1c1c"),b=s("66e5"),q=s("4074"),v=s("0170"),_=s("24e8"),k=s("f09f"),D=s("a370"),y=s("27f9"),C=s("ddd8"),g=s("7f67"),x=s("eebe"),Q=s.n(x),T=Object(m["a"])(d,i,n,!1,null,null,null),w=T.exports;Q()(T,"components",{QBtn:p["a"],QIcon:f["a"],QList:h["a"],QItem:b["a"],QItemSection:q["a"],QItemLabel:v["a"],QDialog:_["a"],QCard:k["a"],QCardSection:D["a"],QInput:y["a"],QSelect:C["a"]}),Q()(T,"directives",{ClosePopup:g["a"]});var P=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"row items-center justify-between q-px-sm"},[e("div",{staticClass:"text-h6"},[t._v("Kupon Diskon")]),e("q-btn",{attrs:{unelevated:"",color:"primary"},on:{click:t.handleAdd}},[e("q-icon",{attrs:{name:"add"}}),e("span",[t._v("Kupon")])],1)],1),e("div",{staticClass:"q-py-md"},[e("q-list",{attrs:{separator:""}},[e("q-item",[e("q-item-section",{attrs:{side:""}},[t._v("#")]),e("q-item-section",[t._v("Label")]),e("q-item-section",[t._v("Kupon Kode")]),e("q-item-section",[t._v("Diskon")]),e("q-item-section",{attrs:{side:""}},[t._v("Action")])],1),t._l(t.coupons,(function(s,o){return e("q-item",{key:o},[e("q-item-section",{attrs:{side:""}},[t._v(t._s(o+1))]),e("q-item-section",[t._v(t._s(s.label))]),e("q-item-section",[t._v(t._s(s.code))]),s.discount?e("q-item-section",["percent"==s.discount.unit?e("q-item-label",[t._v("\n           "+t._s(s.discount.value)+" %\n         ")]):e("q-item-label",[t._v("\n           "+t._s(t.moneyIDR(s.discount.value))+"\n         ")])],1):t._e(),e("q-item-section",{attrs:{side:""}},[e("div",{staticClass:"q-gutter-sm"},[e("q-btn",{attrs:{size:"sm",unelevated:"",color:"red",icon:"eva-trash-2",round:""},on:{click:function(e){return t.handleDelete(s.id)}}}),e("q-btn",{attrs:{size:"sm",unelevated:"",color:"blue",icon:"eva-edit-2",round:""},on:{click:function(e){return t.handleEdit(s)}}})],1)])],1)}))],2)],1),e("q-dialog",{attrs:{persistent:""},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[e("q-card",{staticClass:"card-medium"},[e("div",{staticClass:"card-heading"},[t._v(t._s(t.formType)+" Kupon")]),e("form",{on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[e("q-card-section",{staticClass:"q-gutter-y-sm"},[e("q-input",{attrs:{required:"",filled:"",square:"",label:"Label",rules:[function(t){return!!t||"Field is required"}]},model:{value:t.form.label,callback:function(e){t.$set(t.form,"label",e)},expression:"form.label"}}),e("q-input",{attrs:{required:"",filled:"",square:"",label:"Kode Kupon",rules:[function(t){return!!t||"Field is required"}]},scopedSlots:t._u([{key:"append",fn:function(){return[e("q-btn",{attrs:{label:"Generate",color:"primary",unelevated:""},on:{click:t.generateCoupon}})]},proxy:!0}]),model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}}),e("q-select",{attrs:{required:"",filled:"",square:"",label:"Diskon",options:t.discountOptions,"emit-value":"","map-options":"",rules:[function(t){return!!t||"Field is required"}]},model:{value:t.form.discount_id,callback:function(e){t.$set(t.form,"discount_id",e)},expression:"form.discount_id"}}),e("div",{staticClass:"flex items-center justify-end q-mt-md q-gutter-x-sm"},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Batal"}}),e("q-btn",{attrs:{unelevated:"",color:"primary",type:"submit",label:"Simpan"}})],1)],1)],1)])],1)],1)},I=[],$=(s("d81d"),{name:"CouponBlock",data:function(){return{modal:!1,form:{discount_id:"",code:"",label:""},selectedData:null,formType:"Tambah"}},computed:l()(l()({},Object(c["e"])({discounts:function(t){return t.discount.discounts},coupons:function(t){return t.coupon.coupons}})),{},{discountOptions:function(){var t=[];return this.discounts.map((function(e){t.push({value:e.id,label:e.label})})),t}}),methods:l()(l()(l()({},Object(c["b"])("discount",["getDiscounts"])),Object(c["b"])("coupon",["getCoupons","storeCoupon","updateCoupon","deleteCoupon"])),{},{handleAdd:function(){if(!this.discounts.length)return this.$q.notify({type:"warning",message:"Silahkan tambahkan diskon terlebih dahulu untuk membuat kupon"});this.clearForm(),this.formType="Tambah",this.modal=!0},handleEdit:function(t){this.clearForm(),this.formType="Edit",this.selectedData=t,this.setInputData(),this.modal=!0},handleDelete:function(t){var e=this;this.$q.dialog({message:"Yakin akan menghapus ini?",cancel:!0}).onOk((function(){e.deleteCoupon(t)}))},setInputData:function(){this.form.label=this.selectedData.label,this.form.code=this.selectedData.code,this.form.discount_id=this.selectedData.discount_id},submit:function(){var t=this,e=this.form;"Edit"==this.formType&&(e._method="PUT",e.discount_id=this.selectedData.id,this.updateCoupon(e).then((function(){t.closeModal()}))),"Tambah"==this.formType&&this.storeCoupon(e).then((function(){t.closeModal()}))},closeModal:function(){this.clearForm(),this.modal=!1},clearForm:function(){this.discount_id="",this.code="",this.label=""},generateCoupon:function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",e="",s=0;s<8;s++)e+=t.charAt(Math.floor(Math.random()*t.length));var o=this.coupons.filter((function(t){return t.code==e}));o.length?this.generateCoupon():this.form.code=e}}),mounted:function(){this.getCoupons()}}),F=$,S=Object(m["a"])(F,P,I,!1,null,null,null),j=S.exports;Q()(S,"components",{QBtn:p["a"],QIcon:f["a"],QList:h["a"],QItem:b["a"],QItemSection:q["a"],QItemLabel:v["a"],QDialog:_["a"],QCard:k["a"],QCardSection:D["a"],QInput:y["a"],QSelect:C["a"]}),Q()(S,"directives",{ClosePopup:g["a"]});var M=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"row items-center justify-between q-px-sm"},[e("div",{staticClass:"text-h6"},[t._v("Promo Diskon")]),e("div",{staticClass:"row items-center q-gutter-x-sm"},[e("q-btn",{attrs:{unelevated:"",color:"primary"},on:{click:t.handleAdd}},[e("q-icon",{attrs:{name:"add"}}),e("span",[t._v("Promo")])],1)],1)]),e("div",{staticClass:"q-py-md"},[e("q-list",{attrs:{separator:""}},[e("q-item",[e("q-item-section",{attrs:{side:""}},[t._v("#")]),e("q-item-section",[t._v("Label")]),t.isDesktop?e("q-item-section",[t._v("Diskon")]):t._e(),e("q-item-section",[t._v("Status")]),e("q-item-section",{attrs:{side:""}},[t._v("Action")])],1),t._l(t.promotes,(function(s,o){return e("q-item",{key:o},[e("q-item-section",{attrs:{side:""}},[t._v(t._s(o+1))]),e("q-item-section",[e("q-item-label",[t._v(t._s(s.label)+" ["+t._s(s.products_count)+"]")]),t.isDesktop?t._e():e("div",[e("q-chip",{attrs:{square:"","text-color":"white",color:"teal",size:"sm"}},[t._v(t._s(s.discount.label)+" ")])],1)],1),t.isDesktop?e("q-item-section",[e("div",[e("q-chip",{attrs:{square:"","text-color":"white",color:"teal",size:"sm"}},[t._v(t._s(s.discount.label)+" ")])],1)]):t._e(),e("q-item-section",[e("q-item-label",[e("q-chip",{attrs:{size:"sm","text-color":"white",color:s.is_active?"green":"grey",label:s.is_active?"Active":"Inactive"}})],1)],1),e("q-item-section",{attrs:{side:""}},[e("div",{staticClass:"q-gutter-sm"},[e("q-btn",{attrs:{size:"sm",unelevated:"",color:"red",icon:"eva-trash-2",round:""},on:{click:function(e){return t.handleDelete(s.id)}}}),e("q-btn",{attrs:{size:"sm",unelevated:"",color:"blue",icon:"eva-edit-2",round:""},on:{click:function(e){return t.handleEdit(s)}}}),e("q-btn",{attrs:{size:"sm",unelevated:"",color:"teal",icon:"settings",round:""},on:{click:function(e){return t.$router.push({name:"PromoDetail",params:{id:s.id}})}}})],1)])],1)}))],2)],1),e("div",[e("q-list",t._l(t.products,(function(s){return e("q-item",{key:s.id},[e("q-item-section",[t._v(t._s(s.title))]),e("q-item-section",{attrs:{side:""}})],1)})),1)],1),e("q-dialog",{attrs:{persistent:""},model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[e("q-card",{staticClass:"card-medium"},[e("div",{staticClass:"card-heading"},[t._v(t._s(t.formType)+" Promo")]),e("form",{on:{submit:function(e){return e.preventDefault(),t.submit.apply(null,arguments)}}},[e("q-card-section",{staticClass:"q-gutter-y-sm"},[e("q-input",{attrs:{required:"",filled:"",square:"",label:"Label",rules:[function(t){return!!t||"Field is required"}]},model:{value:t.form.label,callback:function(e){t.$set(t.form,"label",e)},expression:"form.label"}}),e("q-select",{attrs:{required:"",filled:"",square:"",label:"Diskon",options:t.discountOptions,"emit-value":"","map-options":"",rules:[function(t){return!!t||"Field is required"}]},model:{value:t.form.discount_id,callback:function(e){t.$set(t.form,"discount_id",e)},expression:"form.discount_id"}}),e("q-input",{attrs:{label:"Start Date",filled:"",readonly:"",rules:[function(t){return!!t||"Field is required"}]},scopedSlots:t._u([{key:"prepend",fn:function(){return[e("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[e("q-popup-proxy",{attrs:{cover:"","transition-show":"scale","transition-hide":"scale"}},[e("q-date",{attrs:{mask:"YYYY-MM-DD HH:mm"},model:{value:t.form.start_date,callback:function(e){t.$set(t.form,"start_date",e)},expression:"form.start_date"}},[e("div",{staticClass:"row items-center justify-end"},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0},{key:"append",fn:function(){return[e("q-icon",{staticClass:"cursor-pointer",attrs:{name:"access_time"}},[e("q-popup-proxy",{attrs:{cover:"","transition-show":"scale","transition-hide":"scale"}},[e("q-time",{attrs:{mask:"YYYY-MM-DD HH:mm",format24h:""},model:{value:t.form.start_date,callback:function(e){t.$set(t.form,"start_date",e)},expression:"form.start_date"}},[e("div",{staticClass:"row items-center justify-end"},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:t.form.start_date,callback:function(e){t.$set(t.form,"start_date",e)},expression:"form.start_date"}}),e("q-input",{attrs:{label:"End Date",filled:"",readonly:"",rules:[function(t){return!!t||"Field is required"}]},scopedSlots:t._u([{key:"prepend",fn:function(){return[e("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[e("q-popup-proxy",{attrs:{cover:"","transition-show":"scale","transition-hide":"scale"}},[e("q-date",{attrs:{mask:"YYYY-MM-DD HH:mm"},model:{value:t.form.end_date,callback:function(e){t.$set(t.form,"end_date",e)},expression:"form.end_date"}},[e("div",{staticClass:"row items-center justify-end"},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0},{key:"append",fn:function(){return[e("q-icon",{staticClass:"cursor-pointer",attrs:{name:"access_time"}},[e("q-popup-proxy",{attrs:{cover:"","transition-show":"scale","transition-hide":"scale"}},[e("q-time",{attrs:{mask:"YYYY-MM-DD HH:mm",format24h:""},model:{value:t.form.end_date,callback:function(e){t.$set(t.form,"end_date",e)},expression:"form.end_date"}},[e("div",{staticClass:"row items-center justify-end"},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}]),model:{value:t.form.end_date,callback:function(e){t.$set(t.form,"end_date",e)},expression:"form.end_date"}}),e("div",{staticClass:"flex items-center justify-end q-mt-md q-gutter-x-sm"},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",color:"primary",label:"Batal"}}),e("q-btn",{attrs:{unelevated:"",color:"primary",type:"submit",label:"Simpan"}})],1)],1)],1)])],1)],1)},O=[],Y={name:"PromoteBlock",data:function(){return{modal:!1,form:{id:"",discount_id:"",start_date:"",end_date:"",label:""},selectedData:null,formType:"Tambah",search:"",productSearch:[]}},computed:l()(l()({},Object(c["e"])({discounts:function(t){return t.discount.discounts},promotes:function(t){return t.promo.promotes},products:function(t){return t.promo.products}})),{},{discountOptions:function(){var t=[];return this.discounts.map((function(e){t.push({value:e.id,label:e.label})})),t},isDesktop:function(){return window.innerWidth>600}}),methods:l()(l()(l()({},Object(c["b"])("discount",["getDiscounts"])),Object(c["b"])("promo",["getPromotes","storePromote","updatePromote","deletePromote","getProducts"])),{},{handleAdd:function(){if(!this.discounts.length)return this.$q.notify({type:"warning",message:"Silahkan tambahkan diskon terlebih dahulu untuk membuat promo"});this.clearForm(),this.formType="Tambah",this.modal=!0},handleEdit:function(t){this.clearForm(),this.formType="Edit",this.selectedData=t,this.setInputData(),this.modal=!0},handleDelete:function(t){var e=this;this.$q.dialog({message:"Yakin akan menghapus ini?",cancel:!0}).onOk((function(){e.deletePromote(t)}))},setInputData:function(){this.form.id=this.selectedData.id,this.form.label=this.selectedData.label,this.form.start_date=this.selectedData.start_date,this.form.end_date=this.selectedData.end_date,this.form.discount_id=this.selectedData.discount_id},submit:function(){var t=this,e=this.form;"Edit"==this.formType&&(e._method="PUT",this.updatePromote(e).then((function(){t.closeModal()}))),"Tambah"==this.formType&&this.storePromote(e).then((function(){t.closeModal()}))},searchProduct:function(t){console.log(t)},closeModal:function(){this.clearForm(),this.modal=!1},clearForm:function(){this.form.id="",this.form.discount_id="",this.form.label="",this.form.start_date="",this.form.end_date=""}}),mounted:function(){this.getPromotes()}},A=Y,E=s("b047"),L=s("7cbe"),B=s("52ee"),z=s("ca78"),H=Object(m["a"])(A,M,O,!1,null,null,null),K=H.exports;Q()(H,"components",{QBtn:p["a"],QIcon:f["a"],QList:h["a"],QItem:b["a"],QItemSection:q["a"],QItemLabel:v["a"],QChip:E["a"],QDialog:_["a"],QCard:k["a"],QCardSection:D["a"],QInput:y["a"],QSelect:C["a"],QPopupProxy:L["a"],QDate:B["a"],QTime:z["a"]}),Q()(H,"directives",{ClosePopup:g["a"]});var N={name:"DiscountIndex",components:{Discount:w,Coupon:j,Promote:K},data:function(){return{tab:"promo"}},mounted:function(){this.$route.query.q&&(this.tab=this.$route.query.q)}},U=N,G=s("9989"),J=s("e359"),R=s("65c6"),W=s("6ac5"),V=s("429b"),X=s("7460"),Z=s("eb85"),tt=s("adad"),et=s("823b"),st=Object(m["a"])(U,o,a,!1,null,null,null);e["default"]=st.exports;Q()(st,"components",{QPage:G["a"],QHeader:J["a"],QToolbar:R["a"],QBtn:p["a"],QToolbarTitle:W["a"],QTabs:V["a"],QTab:X["a"],QSeparator:Z["a"],QTabPanels:tt["a"],QTabPanel:et["a"]})}}]);