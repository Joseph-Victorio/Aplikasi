(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[41],{"6a66":function(t,e,a){"use strict";a.r(e);a("4de4"),a("ac1f"),a("841c");var r=function(){var t=this,e=t._self._c;return e("q-page",{staticClass:"q-pb-xl"},[e("q-header",{class:t.getHeaderColorBrand},[e("q-toolbar",[e("q-btn",{attrs:{to:{name:"Settings"},flat:"",round:"",dense:"",icon:"eva-arrow-back"}}),e("q-toolbar-title",[t._v("\n        List Pesanan\n      ")])],1),e("div",{staticClass:"box-shadow bg-white text-dark"},[e("q-tabs",{attrs:{"active-color":"primary","outside-arrows":""},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}},[e("q-tab",{attrs:{name:"ALL",label:"Semua","no-caps":""}}),t._l(t.statusOptions,(function(t){return e("q-tab",{key:t.value,attrs:{name:t.value,label:t.label,"no-caps":""}})}))],2)],1)],1),e("div",{staticClass:"q-py-md auto-padding-side"},[e("div",{staticClass:"q-gutter-x-sm q-mt-sm"},[e("q-input",{staticClass:"bg-grey-3 q-px-sm",attrs:{placeholder:"No invoice, nama, email atau ponsel customer",dense:"",borderless:"",clearable:""},on:{keypress:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearchOrder.apply(null,arguments)},clear:t.clearSearch},scopedSlots:t._u([{key:"append",fn:function(){return[e("q-icon",{staticClass:"cursor-pointer",attrs:{name:"eva-search"},on:{click:t.handleSearchOrder}})]},proxy:!0}]),model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1)]),t.orders.count>0?[e("div",[e("q-separator"),e("q-list",{attrs:{separator:""}},[e("q-item",{staticClass:"bg-grey-2"},[e("q-item-section",{staticClass:"gt-xs",attrs:{side:""}},[t._v("\n            #\n          ")]),e("q-item-section",[e("q-item-label",[t._v("Detail")])],1),e("q-item-section",{attrs:{side:""}},[e("q-item-label",[t._v("Actions")])],1)],1),t._l(t.orders.data,(function(a,r){return e("q-item",{key:r},[e("q-item-section",{staticClass:"gt-xs",attrs:{side:"",top:""}},[t._v("\n            "+t._s(r+1)+"\n          ")]),e("q-item-section",{attrs:{top:""}},[e("div",[e("table",{staticClass:"dense"},[e("tr",[e("td",[t._v("Invoice")]),e("td",[t._v(t._s(a.order_ref))])]),e("tr",[e("td",[t._v("Pelanggan")]),e("td",[t._v(t._s(a.customer_name))])]),e("tr",[e("td",[t._v("Telp")]),e("td",[t._v(t._s(a.customer_phone))])]),e("tr",[e("td",[t._v("Tanggal")]),e("td",[t._v(t._s(a.created))])]),e("tr",[e("td",[t._v("Total")]),e("td",[t._v(t._s(t.moneyIDR(a.grand_total)))])]),e("tr",[e("td",[t._v("Status")]),e("td",[e("q-badge",{attrs:{color:t.getOrderStatusColor(a.order_status)}},[t._v(t._s(a.status_label))])],1)]),e("tr",[e("td",[t._v("Pengiriman")]),e("td",[t._v(t._s("COD"==a.shipping_courier_name?"Diantar Kurir Toko":a.shipping_courier_name)+"\n                  ")])]),e("tr",[e("td",[t._v("No Resi")]),e("td",[t._v(t._s(a.shipping_courier_code?a.shipping_courier_code:"-"))])])])])]),e("q-item-section",{attrs:{side:"",top:""}},[e("div",{staticClass:"q-gutter-xs column order-btn-group"},[e("q-btn",{staticClass:"btn-order-item",attrs:{unelevated:"","no-caps":"",padding:"6px 12px",size:"12px",label:"Detail",color:"purple",to:{name:"AdminOrderShow",params:{order_ref:a.order_ref}}}}),e("q-btn",{staticClass:"btn-order-item",attrs:{unelevated:"","no-caps":"",padding:"6px 12px",size:"12px",label:"Kirim Pesan",color:"teal"},on:{click:function(e){return t.handleFollowUp(a)}}}),e("q-btn",{staticClass:"btn-order-item",attrs:{unelevated:"","no-caps":"",padding:"6px 12px",size:"12px",label:"Update Status",color:"blue"},on:{click:function(e){return t.handleUpdateStatus(a)}}}),e("q-btn",{staticClass:"btn-order-item",attrs:{unelevated:"","no-caps":"",padding:"6px 12px",size:"12px",label:"Menu Lain",outline:"",color:"grey-8"}},[e("q-menu",{attrs:{"auto-close":""}},[e("q-list",{attrs:{separator:""}},[e("q-item",{attrs:{clickable:""},on:{click:function(e){return t.handleCopyLink(a.order_ref)}}},[e("q-item-section",[e("span",{staticClass:"nowrap"},[t._v("Salin Invoice Link")])])],1),e("q-item",{attrs:{clickable:""},on:{click:function(e){return t.handleInputResi(a)}}},[e("q-item-section",[t._v("Input Resi")])],1),e("q-item",{attrs:{clickable:""},on:{click:function(e){return t.handleDeleteOrder(a.id)}}},[e("q-item-section",[t._v("Hapus Order")])],1)],1)],1)],1)],1)])],1)}))],2)],1),e("div",{staticClass:"flex justify-center q-py-xl"},[t.orders.count>t.orders.data.length?e("q-btn",{attrs:{outline:"",loading:t.orders.isLoadMore,label:"loadmore...",unelevated:"",color:"primary"},on:{click:t.loadMore}}):t._e()],1)]:t._e(),t.orders.ready&&t.orders.count<=0?e("div",{staticClass:"text-center q-pt-xl"},[t._v("Tidak ada data")]):t._e(),e("q-dialog",{attrs:{persistent:""},model:{value:t.followUpModal,callback:function(e){t.followUpModal=e},expression:"followUpModal"}},[e("follow-up",{attrs:{order:t.currentOrder},on:{close:function(e){t.followUpModal=!1}}})],1),e("q-dialog",{model:{value:t.inputResiModal,callback:function(e){t.inputResiModal=e},expression:"inputResiModal"}},[e("q-card",{staticStyle:{width:"100%","max-width":"420px"},attrs:{square:""}},[e("div",{staticClass:"q-px-md q-py-sm bg-dark text-white text-weight-bold"},[t._v("Input Resi "),t.orderSelected?e("span",[t._v("# "+t._s(t.orderSelected.order_ref))]):t._e()]),e("form",{on:{submit:function(e){return e.preventDefault(),t.submitResi.apply(null,arguments)}}},[e("q-card-section",[e("div",{staticClass:"text-grey-8"},[t._v("No Resi")]),e("q-input",{attrs:{outlined:"",rules:[function(t){return t&&t.length>0||"Wajib diisi"}]},model:{value:t.form.resi,callback:function(e){t.$set(t.form,"resi",e)},expression:"form.resi"}}),e("q-checkbox",{attrs:{label:"Update Status ( Dikirim )"},model:{value:t.form.update_to_ship,callback:function(e){t.$set(t.form,"update_to_ship",e)},expression:"form.update_to_ship"}}),e("div",{staticClass:"flex justify-end q-mt-sm q-gutter-x-sm"},[e("q-btn",{attrs:{outline:"",label:"Batal",color:"primary"},on:{click:function(e){return e.preventDefault(),t.closeModal.apply(null,arguments)}}}),e("q-btn",{attrs:{unelevated:"",type:"submit",label:"Simpan",color:"primary"}})],1)],1)],1)])],1),e("q-dialog",{attrs:{persistent:"","no-shake":""},model:{value:t.updateStatusModal,callback:function(e){t.updateStatusModal=e},expression:"updateStatusModal"}},[e("q-card",{staticStyle:{width:"100%","max-width":"420px"},attrs:{square:""}},[e("div",{staticClass:"q-px-md q-py-sm bg-dark text-white text-weight-bold"},[t._v("Form Update Status")]),e("form",{on:{submit:function(e){return e.preventDefault(),t.submitUpdateStatus.apply(null,arguments)}}},[t.orderSelected?e("q-card-section",[e("div",{staticClass:"text-grey-8"},[t._v("Status")]),e("q-select",{attrs:{outlined:"",rules:[function(t){return t&&t.length>0||"Wajib diisi"}],options:t.statusOptions,"emit-value":"","map-options":""},model:{value:t.formUpdateStatus.status,callback:function(e){t.$set(t.formUpdateStatus,"status",e)},expression:"formUpdateStatus.status"}}),e("div",{staticClass:"q-pb-sm"},["CANCELED"==t.orderSelected.order_status||"CANCELED"==t.formUpdateStatus.status?e("q-checkbox",{attrs:{val:!0},model:{value:t.formUpdateStatus.update_stock,callback:function(e){t.$set(t.formUpdateStatus,"update_stock",e)},expression:"formUpdateStatus.update_stock"}},[e("div",[t._v("Update Stok?")]),e("div",{staticClass:"text-xs text-grey-7"},[t._v("\n                Jika diaktifkan, opsi ini akan mempengaruhi stok\n              ")])]):t._e()],1),e("div",{staticClass:"flex justify-end q-mt-sm q-gutter-x-sm"},[e("q-btn",{attrs:{outline:"",label:"Batal",color:"primary"},on:{click:function(e){return e.preventDefault(),t.closeModal.apply(null,arguments)}}}),e("q-btn",{attrs:{disable:t.orderSelected.order_status==t.formUpdateStatus.status,unelevated:"",type:"submit",label:"Update Status",color:"primary"}})],1)],1):t._e()],1)])],1),e("q-inner-loading",{attrs:{showing:t.stateLoading}})],2)},s=[],i=a("ded3"),o=a.n(i),n=(a("d3b7"),a("e6cf"),a("a79d"),a("2f62")),l=a("cdde"),d=function(){var t=this,e=t._self._c;return e("q-card",{staticStyle:{width:"100%","max-width":"400px"}},[e("form",{on:{submit:function(e){return e.preventDefault(),t.submitMessage.apply(null,arguments)}}},[e("div",{staticClass:"q-px-md q-pt-md"},[e("div",{staticClass:"text-h6"},[t._v(t._s(t.messageButtonLabel))]),e("div",{staticClass:"text-xs text-grey-7"},[t._v("Anda bisa mengedit dengan format pesan anda sendiri.")])]),e("q-card-section",{staticClass:"scroll",staticStyle:{"max-height":"80vh"}},[e("q-input",{staticClass:"textarea-input",attrs:{outlined:"",type:"textarea",rows:"18"},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}}),e("div",{staticClass:"q-mt-md flex justify-end q-gutter-x-sm"},[e("q-btn",{attrs:{outline:"",color:"primary",type:"button",label:"Batal","no-caps":"",unelevated:""},on:{click:function(e){return e.preventDefault(),t.$emit("close")}}}),e("q-btn",{attrs:{unelevated:"",type:"submit",label:"Kirim Whatsapp",color:"primary","no-caps":""}})],1)],1)],1)])},c=[],u=(a("99af"),a("5319"),a("2ca0"),a("b0c0"),{props:["order"],data:function(){return{message:""}},computed:{shop:function(){return this.$store.state.shop},banks:function(){return this.$store.state.bank.banks},messageButtonLabel:function(){return"PENDING"==this.order.order_status?"Follow Up Message":"Send Message"}},methods:{submitMessage:function(){var t="https://api.whatsapp.com";this.$q.platform.is.desktop&&(t="https://web.whatsapp.com");var e="".concat(t,"/send?phone=").concat(this.formatPhoneNumber(this.order.customer_phone),"&text=").concat(encodeURI(this.message));window.open(e,"_blank")},money:function(t){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(t)},formatPhoneNumber:function(t){var e=t.replace(/\D/g,"");return e.startsWith("0")&&(e="62"+e.substr(1)),e},getRoutePath:function(){var t=this.$router.resolve({name:"UserInvoice",params:{order_ref:this.order.order_ref}});return location.origin+t.href},setTextMessage:function(){if(this.order){var t="Halo kak ".concat(this.order.customer_name,"\n");t+="kami dari *".concat(this.shop.name?this.shop.name:"...","*\n"),t+="berikut adalah pesanan kakak pada toko kami:\n\n",t+="Invoice : *".concat(this.order.order_ref,"*\n"),t+="Di pesan pada : ".concat(this.order.created,"\n"),t+="Subtotal : ".concat(this.moneyIDR(this.order.order_subtotal),"\n"),t+="Ongkos Kirim : ".concat(this.moneyIDR(this.order.shipping_cost),"\n"),this.order.order_unique_code&&(t+="Kode Unik : ".concat(this.order.order_unique_code,"\n")),this.order.service_fee&&(t+="Service Fee : ".concat(this.order.service_fee,"\n")),this.order.payment_fee&&(t+="Payment Fee: ".concat(this.moneyIDR(this.order.payment_fee),"\n")),t+="\n*Total : ".concat(this.moneyIDR(this.order.grand_total),"*\n\n"),t+="Untuk detail tagihan dapat dilihat di ".concat(this.getRoutePath(),"\n\n"),t+="Terima Kasih",this.message=t}}},mounted:function(){this.setTextMessage()}}),p=u,m=a("2877"),h=a("f09f"),f=a("a370"),b=a("27f9"),_=a("9c40"),v=a("eebe"),g=a.n(v),k=Object(m["a"])(p,d,c,!1,null,null,null),q=k.exports;g()(k,"components",{QCard:h["a"],QCardSection:f["a"],QInput:b["a"],QBtn:_["a"]});var S={name:"OrderIndex",components:{FollowUp:q},data:function(){return{isFilter:!0,updateStatusModal:!1,statusOptions:[{value:"PENDING",label:"Pending"},{value:"TOSHIP",label:"Perlu Dikirim"},{value:"SHIPPING",label:"Dikirim"},{value:"COMPLETE",label:"Selesai"},{value:"CANCELED",label:"Batal"}],inputResiModal:!1,orderSelected:"",followUpModal:!1,currentOrder:null,search:"",filter:"ALL",form:{order_id:"",resi:"",status:"",update_to_ship:!1},formUpdateStatus:{order_id:"",status:"",update_stock:!1}}},watch:{filter:function(t,e){t!=e&&(this.form.status=t,localStorage.setItem("order_filter",t),this.filterOrder(t))}},computed:{orders:function(){return this.$store.state.order.orders},isMobile:function(){return window.innerWidth<=800}},created:function(){this.orders.data.length<=this.orders.limit&&(this.$route.query.filter?(this.setFilter(this.$route.query.filter),this.filterOrder(this.filter)):localStorage.getItem("order_filter")?(this.setFilter(localStorage.getItem("order_filter")),this.filterOrder(this.filter)):this.getOrders())},methods:o()(o()({},Object(n["b"])("order",["getOrders","getPaginateOrder","getPaginateFilterOrder","destroyOrder","acceptPayment","inputResi","updateStatusOrder","searchOrder","filterOrder","cancelOrder"])),{},{loadMore:function(){this.getPaginateOrder({filter:this.filter,skip:this.orders.data.length})},clearSearch:function(){this.setFilter("ALL"),this.filterOrder(this.filter)},setFilter:function(t){this.filter=t,localStorage.setItem("order_filter",t)},handleSelectMode:function(t){this.isFilter=!this.isFilter,this.search="",this.setFilter("ALL")},changeTab:function(t){this.$router.push({name:"OrderIndex",query:{filter:t}}),this.search="",this.filterOrder(t)},submitUpdateStatus:function(){var t=this;this.$store.commit("SET_LOADING",!0),this.updateStatusOrder(this.formUpdateStatus).then((function(){t.updateStatusModal=!1,t.filterOrder(t.filter)})).finally((function(){return t.$store.commit("SET_LOADING",!1)}))},handleSearchOrder:function(){this.search&&(this.$store.commit("SET_LOADING",!0),this.searchOrder(this.search))},handleCopyLink:function(t){var e=this,a=this.getRoutePath(t);Object(l["a"])(a).then((function(){e.$q.notify({type:"positive",message:"Berhasil menyalin"})})).catch((function(){e.$q.notify({type:"negative",message:"Browser anda tidak support copy to clipboard"})}))},getRoutePath:function(t){var e=this.$router.resolve({name:"UserInvoice",params:{order_ref:t}});return location.origin+e.href},resetOrder:function(){this.orderFiltered=[],this.isFilter=!1,this.setFilter("ALL")},handleDeleteOrder:function(t){var e=this;this.$q.dialog({title:"Yakin akan menghapus data?",message:"data yang dihapus tidak dapat dikembalikan.",options:{type:"checkbox",model:[],items:[{label:"Mengembalikan Stok?",value:!0}]},ok:{label:"Hapus",flat:!0,"no-caps":!0,color:"red-7"},cancel:{label:"Batal",flat:!0,"no-caps":!0}}).onOk((function(a){e.destroyOrder({order_id:t,update_stock:!!a.length}).then((function(t){200==t.status&&e.filterOrder(e.filter)}))})).onCancel((function(){})).onDismiss((function(){}))},handleFollowUp:function(t){this.currentOrder=t,this.followUpModal=!0},handleUpdateStatus:function(t){this.orderSelected=t,this.formUpdateStatus.order_id=t.id,this.formUpdateStatus.status=t.order_status,this.formUpdateStatus.update_stock=!1,this.updateStatusModal=!0},handleInputResi:function(t){this.form.resi="",this.orderSelected=t,this.form.order_id=t.id,this.inputResiModal=!0},closeModal:function(){this.orderSelected="",this.form.order_id="",this.formUpdateStatus.order_id="",this.formUpdateStatus.status="",this.inputResiModal=!1,this.updateStatusModal=!1},submitResi:function(){var t=this;this.inputResi(this.form).then((function(e){if(200==e.status){var a=e.data.results.order_status;t.setFilter(a),t.filterOrder(t.filter)}})),this.closeModal()}}),meta:function(){return{title:"Order List"}}},x=S,y=a("9989"),O=a("e359"),C=a("65c6"),w=a("6ac5"),I=a("429b"),U=a("7460"),M=a("0016"),D=a("eb85"),L=a("1c1c"),R=a("66e5"),Q=a("4074"),P=a("0170"),F=a("58a81"),T=a("4e73"),$=a("24e8"),N=a("8f8e"),A=a("ddd8"),E=a("74f7"),B=Object(m["a"])(x,r,s,!1,null,null,null);e["default"]=B.exports;g()(B,"components",{QPage:y["a"],QHeader:O["a"],QToolbar:C["a"],QBtn:_["a"],QToolbarTitle:w["a"],QTabs:I["a"],QTab:U["a"],QInput:b["a"],QIcon:M["a"],QSeparator:D["a"],QList:L["a"],QItem:R["a"],QItemSection:Q["a"],QItemLabel:P["a"],QBadge:F["a"],QMenu:T["a"],QDialog:$["a"],QCard:h["a"],QCardSection:f["a"],QCheckbox:N["a"],QSelect:A["a"],QInnerLoading:E["a"]})}}]);