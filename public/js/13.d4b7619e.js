(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{"54a2":function(e,t,a){},"68b9":function(e,t,a){"use strict";a("54a2")},"6a66":function(e,t,a){"use strict";a.r(t);a("4de4"),a("ac1f"),a("841c"),a("a15b"),a("1276");var r=function(){var e=this,t=e._self._c;return t("q-page",{staticClass:"q-pb-xl"},[t("q-header",[t("q-toolbar",[t("q-btn",{attrs:{to:{name:"Settings"},flat:"",round:"",dense:"",icon:"eva-arrow-back"}}),t("q-toolbar-title",[e._v("\n       List Pesanan\n      ")])],1)],1),t("div",{staticClass:"box-shadow"},[t("q-tabs",{attrs:{"active-color":"primary","outside-arrows":""},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}},e._l(e.options,(function(e){return t("q-tab",{key:e.value,attrs:{name:e.value,label:e.label,"no-caps":""}})})),1)],1),t("div",{staticClass:"q-py-md auto-padding-side"},[t("div",{staticClass:"q-gutter-x-sm q-mt-sm"},[t("q-input",{staticClass:"bg-grey-3 q-px-sm",attrs:{placeholder:"Ketik no invoice atau ponsel",dense:"",borderless:"",clearable:""},on:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearchOrder.apply(null,arguments)},clear:e.clearSearch},scopedSlots:e._u([{key:"append",fn:function(){return[t("q-icon",{staticClass:"cursor-pointer",attrs:{name:"eva-search"},on:{click:e.handleSearchOrder}})]},proxy:!0}]),model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)]),e.orders.count>0?[t("div",[t("q-separator"),t("q-list",{attrs:{separator:""}},[t("q-item",{staticClass:"bg-grey-2"},[t("q-item-section",{staticClass:"gt-xs",attrs:{side:""}},[e._v("\n          #\n          ")]),t("q-item-section",[t("q-item-label",[e._v("Detail")])],1),t("q-item-section",{attrs:{side:""}},[t("q-item-label",[e._v("Actions")])],1)],1),e._l(e.orders.data,(function(a,r){return t("q-item",{key:r},[t("q-item-section",{staticClass:"gt-xs",attrs:{side:"",top:""}},[e._v("\n            "+e._s(r+1)+"\n          ")]),t("q-item-section",{attrs:{top:""}},[t("div",[t("table",{staticClass:"dense"},[t("tr",[t("td",[e._v("Invoice")]),t("td",[e._v(e._s(a.order_ref))])]),t("tr",[t("td",[e._v("Dibuat")]),t("td",[e._v(e._s(a.created_at))])]),t("tr",[t("td",[e._v("Total")]),t("td",[e._v(e._s(e.moneyIDR(a.grand_total)))])]),t("tr",[t("td",[e._v("Status")]),t("td",[t("q-badge",{attrs:{color:e.changeBadgeColor(a.order_status)}},[e._v(e._s(a.status_label))])],1)]),t("tr",[t("td",[e._v("Nama")]),t("td",[e._v(e._s(a.customer_name))])]),t("tr",[t("td",[e._v("Ponsel")]),t("td",[e._v(e._s(a.customer_whatsapp))])]),t("tr",[t("td",[e._v("Pengiriman")]),t("td",[e._v(e._s(a.shipping_courier_name))])]),t("tr",[t("td",[e._v("Pembayaran")]),t("td",[e._v(e._s(a.transaction?a.transaction.payment_method.split("_").join(" "):""))])])])])]),t("q-item-section",{attrs:{side:"",top:""}},[t("div",{staticClass:"q-gutter-xs column order-btn-group"},[t("q-btn",{attrs:{unelevated:"","no-caps":"",padding:"6px 12px",size:"12px",label:"Detail",color:"purple-7",to:{name:"AdminOrderShow",params:{order_ref:a.order_ref}}}}),t("q-btn",{attrs:{unelevated:"","no-caps":"",padding:"6px 12px",size:"12px",label:e.messageButtonLabel(a.order_status),color:"green-7"},on:{click:function(t){return e.handleFollowUp(a)}}}),e.canInputResi(a)?t("q-btn",{attrs:{unelevated:"","no-caps":"",padding:"6px 12px",size:"12px",label:"Input Resi",color:"blue"},on:{click:function(t){return e.handleInputResi(a)}}}):e._e(),e.canShip(a)?t("q-btn",{attrs:{unelevated:"","no-caps":"",padding:"6px 12px",size:"12px",label:"Kirim COD",color:"teal"},on:{click:function(t){return e.handleKirimCod(a)}}}):e._e(),e.canComplete(a)?t("q-btn",{attrs:{unelevated:"","no-caps":"",padding:"6px 12px",size:"12px",label:"Order Selesai",color:"blue-6"},on:{click:function(t){return e.handleCompletionOrder(a)}}}):e._e(),e.canConfirm(a)?t("q-btn",{attrs:{unelevated:"","no-caps":"",padding:"6px 12px",size:"12px",label:"Konfirmasi",color:"blue-7"},on:{click:function(t){return e.handleConfirmationOrder(a.id)}}}):e._e(),e.canCancelOrder(a)?t("q-btn",{attrs:{unelevated:"","no-caps":"",padding:"6px 12px",size:"12px",label:"Batalkan",color:"red"},on:{click:function(t){return e.handleCancelOrder(a)}}}):e._e()],1)])],1)}))],2)],1),t("div",{staticClass:"flex justify-center q-py-xl"},[e.orders.count>e.orders.data.length?t("q-btn",{attrs:{outline:"",loading:e.orders.isLoadMore,label:"loadmore...",unelevated:"",color:"primary"},on:{click:e.loadMore}}):e._e()],1)]:e._e(),e.orders.ready&&e.orders.count<=0?t("div",{staticClass:"text-center q-pt-xl"},[e._v("Tidak ada data")]):e._e(),t("q-dialog",{model:{value:e.followUpModal,callback:function(t){e.followUpModal=t},expression:"followUpModal"}},[t("follow-up",{attrs:{order:e.currentOrder},on:{close:function(t){e.followUpModal=!1}}})],1),t("q-dialog",{model:{value:e.inputResiModal,callback:function(t){e.inputResiModal=t},expression:"inputResiModal"}},[t("q-card",{staticStyle:{width:"100%","max-width":"420px"},attrs:{square:""}},[t("div",{staticClass:"q-px-md q-py-sm bg-dark text-white text-weight-bold"},[e._v("Input Resi  "),e.orderSelected?t("span",[e._v("# "+e._s(e.orderSelected.order_ref))]):e._e()]),t("form",{on:{submit:function(t){return t.preventDefault(),e.submitResi.apply(null,arguments)}}},[t("q-card-section",[t("div",{staticClass:"text-grey-8"},[e._v("No Resi")]),t("q-input",{attrs:{outlined:"",rules:[function(e){return e&&e.length>0||"Wajib diisi"}]},model:{value:e.form.resi,callback:function(t){e.$set(e.form,"resi",t)},expression:"form.resi"}}),t("div",{staticClass:"flex justify-end q-mt-sm q-gutter-x-sm"},[t("q-btn",{attrs:{outline:"",label:"Batal",color:"primary"},on:{click:function(t){return t.preventDefault(),e.closeModal.apply(null,arguments)}}}),t("q-btn",{attrs:{unelevated:"",type:"submit",label:"Simpan",color:"primary"}})],1)],1)],1)])],1),t("q-inner-loading",{attrs:{showing:e.loading}},[t("q-spinner-facebook",{attrs:{size:"50px",color:"primary"}})],1)],2)},n=[],i=a("ded3"),s=a.n(i),o=(a("d3b7"),a("e6cf"),a("a79d"),a("2f62")),l=function(){var e=this,t=e._self._c;return t("q-card",{staticStyle:{width:"100%","max-width":"400px"}},[t("form",{on:{submit:function(t){return t.preventDefault(),e.submitMessage.apply(null,arguments)}}},[t("div",{staticClass:"q-px-md q-pt-md"},[t("div",{staticClass:"text-h6"},[e._v(e._s(e.messageButtonLabel))]),t("div",{staticClass:"text-xs text-grey-7"},[e._v("Anda bisa mengedit dengan format pesan anda sendiri.")])]),t("q-card-section",{staticClass:"scroll",staticStyle:{"max-height":"80vh"}},[t("q-input",{staticClass:"textarea-input",attrs:{outlined:"",type:"textarea",rows:"18"},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}}),t("div",{staticClass:"q-mt-md flex justify-end q-gutter-x-sm"},[t("q-btn",{attrs:{outline:"",color:"primary",type:"button",label:"Batal","no-caps":"",unelevated:""},on:{click:function(t){return t.preventDefault(),e.$emit("close")}}}),t("q-btn",{attrs:{unelevated:"",type:"submit",label:"Kirim Whatsapp",color:"primary","no-caps":""}})],1)],1)],1)])},d=[],c=(a("99af"),a("5319"),a("2ca0"),a("159b"),a("b0c0"),{props:["order"],data:function(){return{message:""}},computed:{shop:function(){return this.$store.state.shop},banks:function(){return this.$store.state.bank.banks},messageButtonLabel:function(){return"UNPAID"==this.order.order_status||"OVERDUE"==this.order.order_status?"Follow Up Order":"Send Message"}},methods:{submitMessage:function(){var e="https://api.whatsapp.com/send?phone=".concat(this.formatPhoneNumber(this.order.customer_whatsapp),"&text=").concat(encodeURI(this.message));window.open(e,"_blank")},money:function(e){return new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(e)},formatPhoneNumber:function(e){var t=e.replace(/\D/g,"");return t.startsWith("0")&&(t="62"+t.substr(1)),t},getRoutePath:function(){var e=this.$router.resolve({name:"UserInvoice",params:{order_ref:this.order.order_ref}});return location.origin+e.href},setPaymentMessage:function(){var e="Silahkan lakukan pembayaran ke nomor rekening berikut:\n\n";return this.banks.data.length?(this.banks.data.forEach((function(t){e+="*".concat(t.bank_name," - ").concat(t.bank_office,"*\nNorek: ").concat(t.account_number,"\nA.n ").concat(t.account_name,"\n\n")})),e):""},setTextMessage:function(){if(this.order)if("UNPAID"==this.order.order_status){var e="Halo kak ".concat(this.order.customer_name,"\n");e+="kami dari *".concat(this.shop.name?this.shop.name:"...","*\n"),e+="berikut adalah pesanan kakak pada toko kami:\n\n",e+="Invoice : *".concat(this.order.order_ref,"*\n"),e+="Di pesan pada : ".concat(this.order.created_at,"\n"),e+="Subtotal : ".concat(this.moneyIDR(this.order.order_subtotal),"\n"),e+="Ongkos Kirim : ".concat(this.moneyIDR(this.order.shipping_cost),"\n"),this.order.order_unique_code&&(e+="Kode Unik : ".concat(this.order.order_unique_code,"\n")),this.order.service_fee&&(e+="Service Fee : ".concat(this.order.service_fee,"\n")),this.order.payment_fee&&(e+="Payment Fee: ".concat(this.moneyIDR(this.order.payment_fee),"\n")),e+="\n*Total : ".concat(this.moneyIDR(this.order.grand_total),"*\n\n"),e+="Untuk detail tagihan dapat dilihat di ".concat(this.getRoutePath(),"\n\n"),e+="Terima Kasih",this.message=e}else{var t="Halo kak ".concat(this.order.customer_name,"\nkami dari ").concat(this.shop.name?this.shop.name:"...","\n\n......\n\nTerima Kasih\n           ");this.message=t}}},mounted:function(){this.setTextMessage()}}),u=c,p=a("2877"),m=a("f09f"),h=a("a370"),f=a("27f9"),b=a("9c40"),_=a("eebe"),g=a.n(_),v=Object(p["a"])(u,l,d,!1,null,null,null),k=v.exports;g()(v,"components",{QCard:m["a"],QCardSection:h["a"],QInput:f["a"],QBtn:b["a"]});var O={name:"OrderIndex",components:{FollowUp:k},data:function(){return{isFilter:!0,options:[{value:"ALL",label:"Semua"},{value:"UNPAID",label:"Belum Bayar"},{value:"PAID",label:"Dibayar"},{value:"PROCESS",label:"Proses"},{value:"SHIPPING",label:"Dikirim"},{value:"COMPLETE",label:"Selesai"},{value:"CANCELED",label:"Batal"}],inputResiModal:!1,orderSelected:"",followUpModal:!1,currentOrder:null,search:"",filter:"ALL",form:{order_id:"",resi:"",status:""}}},watch:{filter:function(e,t){e!=t&&(this.form.status=e,localStorage.setItem("order_filter",e),this.filterOrder(e))}},computed:s()(s()({},Object(o["d"])({orders:function(e){return e.order.orders},loading:function(e){return e.loading}})),{},{isMobile:function(){return window.innerWidth<=800}}),created:function(){this.orders.data.length<=this.orders.limit&&(this.$route.query.filter?(this.setFilter(this.$route.query.filter),this.filterOrder(this.filter)):localStorage.getItem("order_filter")?(this.setFilter(localStorage.getItem("order_filter")),this.filterOrder(this.filter)):this.getOrders())},methods:s()(s()({},Object(o["b"])("order",["getOrders","getPaginateOrder","getPaginateFilterOrder","destroyOrder","acceptPayment","inputResi","updateStatusOrder","searchOrder","filterOrder","cancelOrder"])),{},{loadMore:function(){this.getPaginateOrder({filter:this.filter,skip:this.orders.data.length})},clearSearch:function(){this.setFilter("ALL"),this.filterOrder(this.filter)},setFilter:function(e){this.filter=e,localStorage.setItem("order_filter",e)},handleSelectMode:function(e){this.isFilter=!this.isFilter,this.search="",this.setFilter("ALL")},changeTab:function(e){this.$router.push({name:"OrderIndex",query:{filter:e}}),this.search="",this.filterOrder(e)},handleKirimCod:function(e){var t=this;this.$q.dialog({title:"Konfirmasi",message:'Akan mengirim pesanan sekarang?, ini akan merubah status pesanan menjadi "sedang dikirim"',cancel:!0}).onOk((function(){t.form.status="SHIPPING",t.form.order_id=e.id,t.handleUpdateStatusOrder()}))},handleUpdateStatusOrder:function(){var e=this;this.$store.commit("SET_LOADING",!0),this.updateStatusOrder(this.form).then((function(){e.setFilter(e.form.status),e.filterOrder(e.filter)})).finally((function(){return e.$store.commit("SET_LOADING",!1)}))},handleCancelOrder:function(e){var t=this;this.$q.dialog({title:"Konfirmasi Pembatalan order",message:"Akan membatalkan order ini?, perubahan ini tidak dapat dikembalikan",cancel:!0}).onOk((function(){t.form.status="CANCELED",t.form.order_id=e.id,t.cancelOrder(e.id).then((function(){t.setFilter(t.form.status),t.filterOrder(t.filter)}))}))},canShip:function(e){return"COD"==e.shipping_courier_name&&("PROCESS"==e.order_status||"UNPAID"==e.order_status||"PAID"==e.order_status)},canComplete:function(e){return"SHIPPING"==e.order_status},canCancelOrder:function(e){return"UNPAID"==e.order_status},handleCompletionOrder:function(e){var t=this;this.$q.dialog({title:"Konfirmasi",message:'Ini akan merubah status pesanan menjadi "selesai"',cancel:!0}).onOk((function(){t.form.status="COMPLETE",t.form.order_id=e.id,t.handleUpdateStatusOrder()}))},handleSearchOrder:function(){this.search&&(this.$store.commit("SET_LOADING",!0),this.searchOrder(this.search))},resetOrder:function(){this.orderFiltered=[],this.isFilter=!1,this.setFilter("ALL")},changeBadgeColor:function(e){return"PAID"==e||"SHIPPING"==e?"teal":"PROCESS"==e?"blue":"COMPLETE"==e?"green":"CANCELED"==e?"red":"grey-7"},canConfirm:function(e){return"COD"!=e.shipping_courier_name&&("UNPAID"==e.order_status||"OVERDUE"==e.order_status)},canInputResi:function(e){return"COD"!=e.shipping_courier_name&&("PROCESS"==e.order_status||"PAID"==e.order_status)},messageButtonLabel:function(e){return"UNPAID"==e||"OVERDUE"==e?"Follow Up":"Kirim Pesan"},handleDeleteOrder:function(e){var t=this;this.$q.dialog({title:"Yakin akan menghapus data?",message:"data yang dihapus tidak dapat dikembalikan.",ok:{label:"Hapus",flat:!0,"no-caps":!0,color:"red-7"},cancel:{label:"Batal",flat:!0,"no-caps":!0}}).onOk((function(){t.destroyOrder(e).then((function(e){200==e.status&&t.filterOrder(t.filter)}))})).onCancel((function(){})).onDismiss((function(){}))},handleConfirmationOrder:function(e){var t=this;this.$q.dialog({title:"Konfirmasi pembayaran",message:"Pastikan pembayaran telah anda terima dengan baik",ok:{label:"Konfirmasi",flat:!0,"no-caps":!0,color:"green-7"},cancel:{label:"Batal",flat:!0,"no-caps":!0}}).onOk((function(){t.acceptPayment(e).then((function(){t.setFilter("PROCESS"),t.filterOrder(t.filter)}))})).onCancel((function(){})).onDismiss((function(){}))},handleFollowUp:function(e){this.currentOrder=e,this.followUpModal=!0},handleInputResi:function(e){this.form.resi="",this.orderSelected=e,this.form.order_id=e.id,this.inputResiModal=!0},closeModal:function(){this.inputResiModal=!1,this.orderSelected="",this.form.order_id=""},submitResi:function(){var e=this;this.inputResi(this.form).then((function(){e.setFilter("SHIPPING"),e.filterOrder(e.filter)})),this.closeModal()}}),meta:function(){return{title:"Order List"}}},q=O,x=(a("68b9"),a("9989")),y=a("e359"),C=a("65c6"),S=a("6ac5"),I=a("429b"),P=a("7460"),D=a("0016"),w=a("eb85"),R=a("1c1c"),L=a("66e5"),M=a("4074"),A=a("0170"),E=a("58a81"),U=a("24e8"),F=a("74f7"),N=a("e669"),Q=Object(p["a"])(q,r,n,!1,null,"0c190bc2",null);t["default"]=Q.exports;g()(Q,"components",{QPage:x["a"],QHeader:y["a"],QToolbar:C["a"],QBtn:b["a"],QToolbarTitle:S["a"],QTabs:I["a"],QTab:P["a"],QInput:f["a"],QIcon:D["a"],QSeparator:w["a"],QList:R["a"],QItem:L["a"],QItemSection:M["a"],QItemLabel:A["a"],QBadge:E["a"],QDialog:U["a"],QCard:m["a"],QCardSection:h["a"],QInnerLoading:F["a"],QSpinnerFacebook:N["a"]})}}]);